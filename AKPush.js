"use strict";var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};function t(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function n(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function i(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function o(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function s(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var r in t)t.hasOwnProperty(r)&&(e[r]=s(e[r],t[r]));return e}function a(e,t,r){e[t]=r}var c=function(e){function r(t,n){var i=e.call(this,n)||this;return i.code=t,i.name="FirebaseError",Object.setPrototypeOf(i,r.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,u.prototype.create),i}return t(r,e),r}(Error),u=function(){function e(e,t,r){this.service=e,this.serviceName=t,this.errors=r}return e.prototype.create=function(e,t){void 0===t&&(t={});for(var r=this.service+"/"+e,n=this.errors[e],i=n?function(e,t){return e.replace(f,(function(e,r){var n=t[r];return null!=n?n.toString():"<"+r+"?>"}))}(n,t):"Error",o=this.serviceName+": "+i+" ("+r+").",s=new c(r,o),a=0,u=Object.keys(t);a<u.length;a++){var d=u[a];"_"!==d.slice(-1)&&(d in s&&console.warn('Overwriting FirebaseError base field "'+d+'" can cause unexpected behavior.'),s[d]=t[d])}return s},e}();var f=/\{\$([^}]+)}/g;function d(e,t){var r=new h(e,t);return r.subscribe.bind(r)}var l,h=function(){function e(e,t){var r=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(r)})).catch((function(e){r.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,r){var n,i=this;if(void 0===e&&void 0===t&&void 0===r)throw new Error("Missing Observer.");void 0===(n=function(e,t){if("object"!=typeof e||null===e)return!1;for(var r=0,n=t;r<n.length;r++){var i=n[r];if(i in e&&"function"==typeof e[i])return!0}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:r}).next&&(n.next=p),void 0===n.error&&(n.error=p),void 0===n.complete&&(n.complete=p);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?n.error(i.finalError):n.complete()}catch(e){}})),this.observers.push(n),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var r=this;this.task.then((function(){if(void 0!==r.observers&&void 0!==r.observers[e])try{t(r.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function p(){}var v=((l={})["no-app"]="No Firebase App '{$name}' has been created - call Firebase App.initializeApp()",l["bad-app-name"]="Illegal App name: '{$name}",l["duplicate-app"]="Firebase App named '{$name}' already exists",l["app-deleted"]="Firebase App named '{$name}' already deleted",l["duplicate-service"]="Firebase service named '{$name}' already registered",l["invalid-app-argument"]="firebase.{$name}() takes either no argument or a Firebase App instance.",l),b=new u("app","Firebase",v);function g(e,t){throw b.create(e,t)}var m=[],y=function(){function e(e,t,r){this.firebase_=r,this.isDeleted_=!1,this.services_={},this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=s(void 0,e),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(e){m.push(e),setTimeout((function(){return e(null)}),0)},removeAuthTokenListener:function(e){m=m.filter((function(t){return t!==e}))}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise((function(t){e.checkDestroyed_(),t()})).then((function(){e.firebase_.INTERNAL.removeApp(e.name_);for(var t=[],r=0,n=Object.keys(e.services_);r<n.length;r++)for(var i=n[r],o=0,s=Object.keys(e.services_[i]);o<s.length;o++){var a=s[o];t.push(e.services_[i][a])}return Promise.all(t.map((function(e){return e.INTERNAL.delete()})))})).then((function(){e.isDeleted_=!0,e.services_={}}))},e.prototype._getService=function(e,t){if(void 0===t&&(t="[DEFAULT]"),this.checkDestroyed_(),this.services_[e]||(this.services_[e]={}),!this.services_[e][t]){var r="[DEFAULT]"!==t?t:void 0,n=this.firebase_.INTERNAL.factories[e](this,this.extendApp.bind(this),r);this.services_[e][t]=n}return this.services_[e][t]},e.prototype.extendApp=function(e){var t=this;s(this,e),e.INTERNAL&&e.INTERNAL.addAuthTokenListener&&(m.forEach((function(e){t.INTERNAL.addAuthTokenListener(e)})),m=[])},e.prototype.checkDestroyed_=function(){this.isDeleted_&&g("app-deleted",{name:this.name_})},e}();function w(e,t){return Object.prototype.hasOwnProperty.call(e,t)}y.prototype.name&&y.prototype.options||y.prototype.delete;var k=!1;try{k="[object process]"===Object.prototype.toString.call(global.process)}catch(oe){}if(k&&console.warn('\nWarning: This is a browser-targeted Firebase bundle but it appears it is being\nrun in a Node environment.  If running in a Node environment, make sure you\nare using the bundle specified by the "main" field in package.json.\n\nIf you are using Webpack, you can specify "main" as the first item in\n"resolve.mainFields":\nhttps://webpack.js.org/configuration/resolve/#resolvemainfields\n\nIf using Rollup, use the rollup-plugin-node-resolve plugin and set "module"\nto false and "main" to true:\nhttps://github.com/rollup/rollup-plugin-node-resolve\n'),self&&"firebase"in self){console.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var S=self.firebase.SDK_VERSION;S&&S.indexOf("LITE")>=0&&console.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var _=function e(){var t=function(e){var t={},r={},n={},i={__esModule:!0,initializeApp:function(r,n){void 0===n&&(n={}),"object"==typeof n&&null!==n||(n={name:n});var o=n;void 0===o.name&&(o.name="[DEFAULT]");var s=o.name;"string"==typeof s&&s||g("bad-app-name",{name:String(s)}),w(t,s)&&g("duplicate-app",{name:s});var a=new e(r,o,i);return t[s]=a,u(a,"create"),a},app:o,apps:null,Promise:Promise,SDK_VERSION:"5.11.0",INTERNAL:{registerService:function(t,a,u,f,d){function l(e){return void 0===e&&(e=o()),"function"!=typeof e[t]&&g("invalid-app-argument",{name:t}),e[t]()}return void 0===d&&(d=!1),r[t]&&g("duplicate-service",{name:t}),r[t]=a,f&&(n[t]=f,c().forEach((function(e){f("create",e)}))),void 0!==u&&s(l,u),i[t]=l,e.prototype[t]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return this._getService.bind(this,t).apply(this,d?e:[])},l},removeApp:function(e){u(t[e],"delete"),delete t[e]},factories:r,useAsService:f}};function o(e){return w(t,e=e||"[DEFAULT]")||g("no-app",{name:e}),t[e]}function c(){return Object.keys(t).map((function(e){return t[e]}))}function u(e,t){for(var i=0,o=Object.keys(r);i<o.length;i++){var s=f(e,o[i]);if(null===s)return;n[s]&&n[s](t,e)}}function f(e,t){if("serverAuth"===t)return null;var r=t;return e.options,r}return a(i,"default",i),Object.defineProperty(i,"apps",{get:c}),a(o,"App",e),i}(y);return t.INTERNAL=r({},t.INTERNAL,{createFirebaseNamespace:e,extendNamespace:function(e){s(t,e)},createSubscribe:d,ErrorFactory:u,deepExtend:s}),t}(),T=function(e){function r(t,n){var i=e.call(this,n)||this;return i.code=t,i.name="FirebaseError",Object.setPrototypeOf(i,r.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,M.prototype.create),i}return t(r,e),r}(Error),M=function(){function e(e,t,r){this.service=e,this.serviceName=t,this.errors=r}return e.prototype.create=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=t[0]||{},i=this.service+"/"+e,o=this.errors[e],s=o?I(o,n):"Error",a=this.serviceName+": "+s+" ("+i+").",c=new T(i,a),u=0,f=Object.keys(n);u<f.length;u++){var d=f[u];"_"!==d.slice(-1)&&(d in c&&console.warn('Overwriting FirebaseError base field "'+d+'" can cause unexpected behavior.'),c[d]=n[d])}return c},e}();function I(e,t){return e.replace(N,(function(e,r){var n=t[r];return null!=n?n.toString():"<"+r+"?>"}))}var N=/\{\$([^}]+)}/g;function P(e,t){var r=new O(e,t);return r.subscribe.bind(r)}var E,O=function(){function e(e,t){var r=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(r)})).catch((function(e){r.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,r){var n,i=this;if(void 0===e&&void 0===t&&void 0===r)throw new Error("Missing Observer.");void 0===(n=function(e,t){if("object"!=typeof e||null===e)return!1;for(var r=0,n=t;r<n.length;r++){var i=n[r];if(i in e&&"function"==typeof e[i])return!0}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:r}).next&&(n.next=F),void 0===n.error&&(n.error=F),void 0===n.complete&&(n.complete=F);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?n.error(i.finalError):n.complete()}catch(e){}})),this.observers.push(n),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var r=this;this.task.then((function(){if(void 0!==r.observers&&void 0!==r.observers[e])try{t(r.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function F(){}var A,D,R=((E={})["only-available-in-window"]="This method is available in a Window context.",E["only-available-in-sw"]="This method is available in a service worker context.",E["should-be-overriden"]="This method should be overriden by extended classes.",E["bad-sender-id"]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",E["permission-default"]="The required permissions were not granted and dismissed instead.",E["permission-blocked"]="The required permissions were not granted and blocked instead.",E["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",E["notifications-blocked"]="Notifications have been blocked.",E["failed-serviceworker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",E["sw-registration-expected"]="A service worker registration was the expected input.",E["get-subscription-failed"]="There was an error when trying to get any existing Push Subscriptions.",E["invalid-saved-token"]="Unable to access details of the saved token.",E["sw-reg-redundant"]="The service worker being used for push was made redundant.",E["token-subscribe-failed"]="A problem occured while subscribing the user to FCM: {$errorInfo}",E["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",E["token-subscribe-no-push-set"]="FCM returned an invalid response when getting an FCM token.",E["token-unsubscribe-failed"]="A problem occured while unsubscribing the user from FCM: {$errorInfo}",E["token-update-failed"]="A problem occured while updating the user from FCM: {$errorInfo}",E["token-update-no-token"]="FCM returned no token when updating the user to push.",E["use-sw-before-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",E["invalid-delete-token"]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",E["delete-token-not-found"]="The deletion attempt for token could not be performed as the token was not found.",E["delete-scope-not-found"]="The deletion attempt for service worker scope could not be performed as the scope was not found.",E["bg-handler-function-expected"]="The input to setBackgroundMessageHandler() must be a function.",E["no-window-client-to-msg"]="An attempt was made to message a non-existant window client.",E["unable-to-resubscribe"]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$errorInfo}",E["no-fcm-token-for-resubscribe"]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",E["failed-to-delete-token"]="Unable to delete the currently saved token.",E["no-sw-in-reg"]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",E["incorrect-gcm-sender-id"]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",E["bad-scope"]="The service worker scope must be a string with at least one character.",E["bad-vapid-key"]="The public VAPID key is not a Uint8Array with 65 bytes.",E["bad-subscription"]="The subscription must be a valid PushSubscription.",E["bad-token"]="The FCM Token used for storage / lookup was not a valid token string.",E["bad-push-set"]="The FCM push set used for storage / lookup was not not a valid push set string.",E["failed-delete-vapid-key"]="The VAPID key could not be deleted.",E["invalid-public-vapid-key"]="The public VAPID key must be a string.",E["use-public-key-before-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",E["public-vapid-key-decryption-failed"]="The public VAPID key did not equal 65 bytes when decrypted.",E),x=new M("messaging","Messaging",R),j=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),C="https://fcm.googleapis.com";function B(e,t){if(null==e||null==t)return!1;if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var r=new DataView(e),n=new DataView(t),i=0;i<e.byteLength;i++)if(r.getUint8(i)!==n.getUint8(i))return!1;return!0}function W(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e}(t)))}function L(e){return W(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}!function(e){e.TYPE_OF_MSG="firebase-messaging-msg-type",e.DATA="firebase-messaging-msg-data"}(A||(A={})),function(e){e.PUSH_MSG_RECEIVED="push-msg-received",e.NOTIFICATION_CLICKED="notification-clicked"}(D||(D={}));var U=function(){function e(){}return e.prototype.getToken=function(e,t,r){return n(this,void 0,void 0,(function(){var n,o,s,a,c,u,f,d,l;return i(this,(function(i){switch(i.label){case 0:n=L(t.getKey("p256dh")),o=L(t.getKey("auth")),s="authorized_entity="+e+"&endpoint="+t.endpoint+"&encryption_key="+n+"&encryption_auth="+o,B(r.buffer,j.buffer)||(a=L(r),s+="&application_pub_key="+a),(c=new Headers).append("Content-Type","application/x-www-form-urlencoded"),u={method:"POST",headers:c,body:s},i.label=1;case 1:return i.trys.push([1,4,,5]),[4,fetch(C+"/fcm/connect/subscribe",u)];case 2:return[4,i.sent().json()];case 3:return f=i.sent(),[3,5];case 4:throw d=i.sent(),x.create("token-subscribe-failed",{errorInfo:d});case 5:if(f.error)throw l=f.error.message,x.create("token-subscribe-failed",{errorInfo:l});if(!f.token)throw x.create("token-subscribe-no-token");if(!f.pushSet)throw x.create("token-subscribe-no-push-set");return[2,{token:f.token,pushSet:f.pushSet}]}}))}))},e.prototype.updateToken=function(e,t,r,o,s){return n(this,void 0,void 0,(function(){var n,a,c,u,f,d,l,h,p;return i(this,(function(i){switch(i.label){case 0:n=L(o.getKey("p256dh")),a=L(o.getKey("auth")),c="push_set="+r+"&token="+t+"&authorized_entity="+e+"&endpoint="+o.endpoint+"&encryption_key="+n+"&encryption_auth="+a,B(s.buffer,j.buffer)||(u=L(s),c+="&application_pub_key="+u),(f=new Headers).append("Content-Type","application/x-www-form-urlencoded"),d={method:"POST",headers:f,body:c},i.label=1;case 1:return i.trys.push([1,4,,5]),[4,fetch(C+"/fcm/connect/subscribe",d)];case 2:return[4,i.sent().json()];case 3:return l=i.sent(),[3,5];case 4:throw h=i.sent(),x.create("token-update-failed",{errorInfo:h});case 5:if(l.error)throw p=l.error.message,x.create("token-update-failed",{errorInfo:p});if(!l.token)throw x.create("token-update-no-token");return[2,l.token]}}))}))},e.prototype.deleteToken=function(e,t,r){return n(this,void 0,void 0,(function(){var n,o,s,a,c,u;return i(this,(function(i){switch(i.label){case 0:n="authorized_entity="+e+"&token="+t+"&pushSet="+r,(o=new Headers).append("Content-Type","application/x-www-form-urlencoded"),s={method:"POST",headers:o,body:n},i.label=1;case 1:return i.trys.push([1,4,,5]),[4,fetch(C+"/fcm/connect/unsubscribe",s)];case 2:return[4,i.sent().json()];case 3:if((a=i.sent()).error)throw c=a.error.message,x.create("token-unsubscribe-failed",{errorInfo:c});return[3,5];case 4:throw u=i.sent(),x.create("token-unsubscribe-failed",{errorInfo:u});case 5:return[2]}}))}))},e}();function z(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),n=new Uint8Array(r.length),i=0;i<r.length;++i)n[i]=r.charCodeAt(i);return n}function V(){var e=indexedDB.open("undefined");e.onerror=function(e){},e.onsuccess=function(t){!function(e){if(e.objectStoreNames.contains("fcm_token_object_Store")){var t=e.transaction("fcm_token_object_Store").objectStore("fcm_token_object_Store"),r=new U,n=t.openCursor();n.onerror=function(e){console.warn("Unable to cleanup old IDB.",e)},n.onsuccess=function(){var t=n.result;if(t){var i=t.value;r.deleteToken(i.fcmSenderId,i.fcmToken,i.fcmPushSet),t.continue()}else e.close(),indexedDB.deleteDatabase("undefined")}}}(e.result)}}var K=function(){function e(){this.dbPromise=null}return e.prototype.get=function(e){return this.createTransaction((function(t){return t.get(e)}))},e.prototype.getIndex=function(e,t){return this.createTransaction((function(r){return r.index(e).get(t)}))},e.prototype.put=function(e){return this.createTransaction((function(t){return t.put(e)}),"readwrite")},e.prototype.delete=function(e){return this.createTransaction((function(t){return t.delete(e)}),"readwrite")},e.prototype.closeDatabase=function(){return n(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.dbPromise?[4,this.dbPromise]:[3,2];case 1:e.sent().close(),this.dbPromise=null,e.label=2;case 2:return[2]}}))}))},e.prototype.createTransaction=function(e,t){return void 0===t&&(t="readonly"),n(this,void 0,void 0,(function(){var r,n,o,s;return i(this,(function(i){switch(i.label){case 0:return[4,this.getDb()];case 1:return r=i.sent(),n=r.transaction(this.objectStoreName,t),o=n.objectStore(this.objectStoreName),[4,q(e(o))];case 2:return s=i.sent(),[2,new Promise((function(e,t){n.oncomplete=function(){e(s)},n.onerror=function(){t(n.error)}}))]}}))}))},e.prototype.getDb=function(){var e=this;return this.dbPromise||(this.dbPromise=new Promise((function(t,r){var n=indexedDB.open(e.dbName,e.dbVersion);n.onsuccess=function(){t(n.result)},n.onerror=function(){e.dbPromise=null,r(n.error)},n.onupgradeneeded=function(t){return e.onDbUpgrade(n,t)}}))),this.dbPromise},e}();function q(e){return new Promise((function(t,r){e.onsuccess=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}var G=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.dbName="fcm_token_details_db",t.dbVersion=3,t.objectStoreName="fcm_token_object_Store",t}return t(o,e),o.prototype.onDbUpgrade=function(e,t){var n=e.result;switch(t.oldVersion){case 0:(i=n.createObjectStore(this.objectStoreName,{keyPath:"swScope"})).createIndex("fcmSenderId","fcmSenderId",{unique:!1}),i.createIndex("fcmToken","fcmToken",{unique:!0});case 1:V();case 2:var i,o=(i=e.transaction.objectStore(this.objectStoreName)).openCursor();o.onsuccess=function(){var e=o.result;if(e){var t=e.value,n=r({},t);t.createTime||(n.createTime=Date.now()),"string"==typeof t.vapidKey&&(n.vapidKey=z(t.vapidKey)),"string"==typeof t.auth&&(n.auth=z(t.auth).buffer),"string"==typeof t.auth&&(n.p256dh=z(t.p256dh).buffer),e.update(n),e.continue()}}}},o.prototype.getTokenDetailsFromToken=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){if(!e)throw x.create("bad-token");return H({fcmToken:e}),[2,this.getIndex("fcmToken",e)]}))}))},o.prototype.getTokenDetailsFromSWScope=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){if(!e)throw x.create("bad-scope");return H({swScope:e}),[2,this.get(e)]}))}))},o.prototype.saveTokenDetails=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){if(!e.swScope)throw x.create("bad-scope");if(!e.vapidKey)throw x.create("bad-vapid-key");if(!e.endpoint||!e.auth||!e.p256dh)throw x.create("bad-subscription");if(!e.fcmSenderId)throw x.create("bad-sender-id");if(!e.fcmToken)throw x.create("bad-token");if(!e.fcmPushSet)throw x.create("bad-push-set");return H(e),[2,this.put(e)]}))}))},o.prototype.deleteToken=function(e){return n(this,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return"string"!=typeof e||0===e.length?[2,Promise.reject(x.create("invalid-delete-token"))]:[4,this.getTokenDetailsFromToken(e)];case 1:if(!(t=r.sent()))throw x.create("delete-token-not-found");return[4,this.delete(t.swScope)];case 2:return r.sent(),[2,t]}}))}))},o}(K);function H(e){if(e.fcmToken&&("string"!=typeof e.fcmToken||0===e.fcmToken.length))throw x.create("bad-token");if(e.swScope&&("string"!=typeof e.swScope||0===e.swScope.length))throw x.create("bad-scope");if(e.vapidKey&&(!(e.vapidKey instanceof Uint8Array)||65!==e.vapidKey.length))throw x.create("bad-vapid-key");if(e.endpoint&&("string"!=typeof e.endpoint||0===e.endpoint.length))throw x.create("bad-subscription");if(e.auth&&!(e.auth instanceof ArrayBuffer))throw x.create("bad-subscription");if(e.p256dh&&!(e.p256dh instanceof ArrayBuffer))throw x.create("bad-subscription");if(e.fcmSenderId&&("string"!=typeof e.fcmSenderId||0===e.fcmSenderId.length))throw x.create("bad-sender-id");if(e.fcmPushSet&&("string"!=typeof e.fcmPushSet||0===e.fcmPushSet.length))throw x.create("bad-push-set")}var Q=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.dbName="fcm_vapid_details_db",t.dbVersion=1,t.objectStoreName="fcm_vapid_object_Store",t}return t(r,e),r.prototype.onDbUpgrade=function(e){e.result.createObjectStore(this.objectStoreName,{keyPath:"swScope"})},r.prototype.getVapidFromSWScope=function(e){return n(this,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:if("string"!=typeof e||0===e.length)throw x.create("bad-scope");return[4,this.get(e)];case 1:return[2,(t=r.sent())?t.vapidKey:void 0]}}))}))},r.prototype.saveVapidDetails=function(e,t){return n(this,void 0,void 0,(function(){var r;return i(this,(function(n){if("string"!=typeof e||0===e.length)throw x.create("bad-scope");if(null===t||65!==t.length)throw x.create("bad-vapid-key");return r={swScope:e,vapidKey:t},[2,this.put(r)]}))}))},r.prototype.deleteVapidDetails=function(e){return n(this,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return[4,this.getVapidFromSWScope(e)];case 1:if(!(t=r.sent()))throw x.create("delete-scope-not-found");return[4,this.delete(e)];case 2:return r.sent(),[2,t]}}))}))},r}(K),Y=function(){function e(e){var t=this;if(!e.options.messagingSenderId||"string"!=typeof e.options.messagingSenderId)throw x.create("bad-sender-id");this.messagingSenderId=e.options.messagingSenderId,this.tokenDetailsModel=new G,this.vapidDetailsModel=new Q,this.iidModel=new U,this.app=e,this.INTERNAL={delete:function(){return t.delete()}}}return e.prototype.getToken=function(){return n(this,void 0,void 0,(function(){var e,t,r,n,o;return i(this,(function(i){switch(i.label){case 0:if("denied"===(e=this.getNotificationPermission_()))throw x.create("notifications-blocked");return"granted"!==e?[2,null]:[4,this.getSWRegistration_()];case 1:return t=i.sent(),[4,this.getPublicVapidKey_()];case 2:return r=i.sent(),[4,this.getPushSubscription(t,r)];case 3:return n=i.sent(),[4,this.tokenDetailsModel.getTokenDetailsFromSWScope(t.scope)];case 4:return(o=i.sent())?[2,this.manageExistingToken(t,n,r,o)]:[2,this.getNewToken(t,n,r)]}}))}))},e.prototype.manageExistingToken=function(e,t,r,o){return n(this,void 0,void 0,(function(){var n;return i(this,(function(i){switch(i.label){case 0:return n=function(e,t,r){if(!r.vapidKey||!B(t.buffer,r.vapidKey.buffer))return!1;var n=e.endpoint===r.endpoint,i=B(e.getKey("auth"),r.auth),o=B(e.getKey("p256dh"),r.p256dh);return n&&i&&o}(t,r,o),n?Date.now()<o.createTime+6048e5?[2,o.fcmToken]:[2,this.updateToken(e,t,r,o)]:[4,this.deleteTokenFromDB(o.fcmToken)];case 1:return i.sent(),[2,this.getNewToken(e,t,r)]}}))}))},e.prototype.updateToken=function(e,t,r,o){return n(this,void 0,void 0,(function(){var n,s,a;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,4,,6]),[4,this.iidModel.updateToken(this.messagingSenderId,o.fcmToken,o.fcmPushSet,t,r)];case 1:return n=i.sent(),s={swScope:e.scope,vapidKey:r,fcmSenderId:this.messagingSenderId,fcmToken:n,fcmPushSet:o.fcmPushSet,createTime:Date.now(),endpoint:t.endpoint,auth:t.getKey("auth"),p256dh:t.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(s)];case 2:return i.sent(),[4,this.vapidDetailsModel.saveVapidDetails(e.scope,r)];case 3:return i.sent(),[2,n];case 4:return a=i.sent(),[4,this.deleteToken(o.fcmToken)];case 5:throw i.sent(),a;case 6:return[2]}}))}))},e.prototype.getNewToken=function(e,t,r){return n(this,void 0,void 0,(function(){var n,o;return i(this,(function(i){switch(i.label){case 0:return[4,this.iidModel.getToken(this.messagingSenderId,t,r)];case 1:return n=i.sent(),o={swScope:e.scope,vapidKey:r,fcmSenderId:this.messagingSenderId,fcmToken:n.token,fcmPushSet:n.pushSet,createTime:Date.now(),endpoint:t.endpoint,auth:t.getKey("auth"),p256dh:t.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(o)];case 2:return i.sent(),[4,this.vapidDetailsModel.saveVapidDetails(e.scope,r)];case 3:return i.sent(),[2,n.token]}}))}))},e.prototype.deleteToken=function(e){return n(this,void 0,void 0,(function(){var t,r;return i(this,(function(n){switch(n.label){case 0:return[4,this.deleteTokenFromDB(e)];case 1:return n.sent(),[4,this.getSWRegistration_()];case 2:return(t=n.sent())?[4,t.pushManager.getSubscription()]:[3,4];case 3:if(r=n.sent())return[2,r.unsubscribe()];n.label=4;case 4:return[2,!0]}}))}))},e.prototype.deleteTokenFromDB=function(e){return n(this,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return[4,this.tokenDetailsModel.deleteToken(e)];case 1:return t=r.sent(),[4,this.iidModel.deleteToken(t.fcmSenderId,t.fcmToken,t.fcmPushSet)];case 2:return r.sent(),[2]}}))}))},e.prototype.getPushSubscription=function(e,t){return e.pushManager.getSubscription().then((function(r){return r||e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t})}))},e.prototype.requestPermission=function(){throw x.create("only-available-in-window")},e.prototype.useServiceWorker=function(e){throw x.create("only-available-in-window")},e.prototype.usePublicVapidKey=function(e){throw x.create("only-available-in-window")},e.prototype.onMessage=function(e,t,r){throw x.create("only-available-in-window")},e.prototype.onTokenRefresh=function(e,t,r){throw x.create("only-available-in-window")},e.prototype.setBackgroundMessageHandler=function(e){throw x.create("only-available-in-sw")},e.prototype.delete=function(){return n(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,Promise.all([this.tokenDetailsModel.closeDatabase(),this.vapidDetailsModel.closeDatabase()])];case 1:return e.sent(),[2]}}))}))},e.prototype.getNotificationPermission_=function(){return Notification.permission},e.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel},e.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel},e.prototype.getIidModel=function(){return this.iidModel},e}();var J=function(e){function o(t){var r=e.call(this,t)||this;return r.bgMessageHandler=null,self.addEventListener("push",(function(e){r.onPush(e)})),self.addEventListener("pushsubscriptionchange",(function(e){r.onSubChange(e)})),self.addEventListener("notificationclick",(function(e){r.onNotificationClick(e)})),r}return t(o,e),o.prototype.onPush=function(e){e.waitUntil(this.onPush_(e))},o.prototype.onSubChange=function(e){e.waitUntil(this.onSubChange_(e))},o.prototype.onNotificationClick=function(e){e.waitUntil(this.onNotificationClick_(e))},o.prototype.onPush_=function(e){return n(this,void 0,void 0,(function(){var t,r,n,o,s,a;return i(this,(function(i){switch(i.label){case 0:if(!e.data)return[2];try{t=e.data.json()}catch(e){return[2]}return[4,this.hasVisibleClients_()];case 1:return i.sent()?[2,this.sendMessageToWindowClients_(t)]:(r=this.getNotificationData_(t))?(n=r.title||"",[4,this.getSWRegistration_()]):[3,3];case 2:return o=i.sent(),s=r.actions,a=Notification.maxActions,s&&a&&s.length>a&&console.warn("This browser only supports "+a+" actions.The remaining actions will not be displayed."),[2,o.showNotification(n,r)];case 3:return this.bgMessageHandler?[4,this.bgMessageHandler(t)]:[3,5];case 4:return i.sent(),[2];case 5:return[2]}}))}))},o.prototype.onSubChange_=function(e){return n(this,void 0,void 0,(function(){var e,t,r,n;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.getSWRegistration_()];case 1:return e=i.sent(),[3,3];case 2:throw t=i.sent(),x.create("unable-to-resubscribe",{errorInfo:t});case 3:return i.trys.push([3,5,,8]),[4,e.pushManager.getSubscription()];case 4:return i.sent(),[3,8];case 5:return r=i.sent(),[4,this.getTokenDetailsModel().getTokenDetailsFromSWScope(e.scope)];case 6:if(!(n=i.sent()))throw r;return[4,this.deleteToken(n.fcmToken)];case 7:throw i.sent(),r;case 8:return[2]}}))}))},o.prototype.onNotificationClick_=function(e){return n(this,void 0,void 0,(function(){var t,r,n,o;return i(this,(function(i){switch(i.label){case 0:return e.notification&&e.notification.data&&e.notification.data.FCM_MSG?e.action?[2]:(e.stopImmediatePropagation(),e.notification.close(),(t=e.notification.data.FCM_MSG).notification&&(r=t.fcmOptions&&t.fcmOptions.link||t.notification.click_action)?[4,this.getWindowClient_(r)]:[2]):[2];case 1:return(n=i.sent())?[3,3]:[4,self.clients.openWindow(r)];case 2:return n=i.sent(),[3,5];case 3:return[4,n.focus()];case 4:n=i.sent(),i.label=5;case 5:return n?(delete t.notification,delete t.fcmOptions,o=$(D.NOTIFICATION_CLICKED,t),[2,this.attemptToMessageClient_(n,o)]):[2]}}))}))},o.prototype.getNotificationData_=function(e){var t;if(e&&"object"==typeof e.notification){var n=r({},e.notification);return n.data=r({},e.notification.data,((t={}).FCM_MSG=e,t)),n}},o.prototype.setBackgroundMessageHandler=function(e){if(!e||"function"!=typeof e)throw x.create("bg-handler-function-expected");this.bgMessageHandler=e},o.prototype.getWindowClient_=function(e){return n(this,void 0,void 0,(function(){var t,r,n,o;return i(this,(function(i){switch(i.label){case 0:return t=new URL(e,self.location.href).href,[4,X()];case 1:for(r=i.sent(),n=null,o=0;o<r.length;o++)if(new URL(r[o].url,self.location.href).href===t){n=r[o];break}return[2,n]}}))}))},o.prototype.attemptToMessageClient_=function(e,t){return n(this,void 0,void 0,(function(){return i(this,(function(r){if(!e)throw x.create("no-window-client-to-msg");return e.postMessage(t),[2]}))}))},o.prototype.hasVisibleClients_=function(){return n(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,X()];case 1:return[2,e.sent().some((function(e){return"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://")}))]}}))}))},o.prototype.sendMessageToWindowClients_=function(e){return n(this,void 0,void 0,(function(){var t,r,n=this;return i(this,(function(i){switch(i.label){case 0:return[4,X()];case 1:return t=i.sent(),r=$(D.PUSH_MSG_RECEIVED,e),[4,Promise.all(t.map((function(e){return n.attemptToMessageClient_(e,r)})))];case 2:return i.sent(),[2]}}))}))},o.prototype.getSWRegistration_=function(){return n(this,void 0,void 0,(function(){return i(this,(function(e){return[2,self.registration]}))}))},o.prototype.getPublicVapidKey_=function(){return n(this,void 0,void 0,(function(){var e,t;return i(this,(function(r){switch(r.label){case 0:return[4,this.getSWRegistration_()];case 1:if(!(e=r.sent()))throw x.create("sw-registration-expected");return[4,this.getVapidDetailsModel().getVapidFromSWScope(e.scope)];case 2:return null==(t=r.sent())?[2,j]:[2,t]}}))}))},o}(Y);function X(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function $(e,t){var r;return(r={})[A.TYPE_OF_MSG]=e,r[A.DATA]=t,r}var Z,ee=function(e){function r(t){var r=e.call(this,t)||this;return r.registrationToUse=null,r.publicVapidKeyToUse=null,r.manifestCheckPromise=null,r.messageObserver=null,r.tokenRefreshObserver=null,r.onMessageInternal=P((function(e){r.messageObserver=e})),r.onTokenRefreshInternal=P((function(e){r.tokenRefreshObserver=e})),r.setupSWMessageListener_(),r}return t(r,e),r.prototype.getToken=function(){return n(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.manifestCheckPromise||(this.manifestCheckPromise=function(){return n(this,void 0,void 0,(function(){var e,t;return i(this,(function(r){switch(r.label){case 0:if(!(e=document.querySelector('link[rel="manifest"]')))return[2];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,fetch(e.href)];case 2:return[4,r.sent().json()];case 3:return t=r.sent(),[3,5];case 4:return r.sent(),[2];case 5:if(!t||!t.gcm_sender_id)return[2];if("103953800507"!==t.gcm_sender_id)throw x.create("incorrect-gcm-sender-id");return[2]}}))}))}()),[4,this.manifestCheckPromise];case 1:return t.sent(),[2,e.prototype.getToken.call(this)]}}))}))},r.prototype.requestPermission=function(){return n(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return"granted"===this.getNotificationPermission_()?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(e=t.sent()))return[2];throw"denied"===e?x.create("permission-blocked"):x.create("permission-default")}}))}))},r.prototype.useServiceWorker=function(e){if(!(e instanceof ServiceWorkerRegistration))throw x.create("sw-registration-expected");if(null!=this.registrationToUse)throw x.create("use-sw-before-get-token");this.registrationToUse=e},r.prototype.usePublicVapidKey=function(e){if("string"!=typeof e)throw x.create("invalid-public-vapid-key");if(null!=this.publicVapidKeyToUse)throw x.create("use-public-key-before-get-token");var t=z(e);if(65!==t.length)throw x.create("public-vapid-key-decryption-failed");this.publicVapidKeyToUse=t},r.prototype.onMessage=function(e,t,r){return"function"==typeof e?this.onMessageInternal(e,t,r):this.onMessageInternal(e)},r.prototype.onTokenRefresh=function(e,t,r){return"function"==typeof e?this.onTokenRefreshInternal(e,t,r):this.onTokenRefreshInternal(e)},r.prototype.waitForRegistrationToActivate_=function(e){var t=e.installing||e.waiting||e.active;return new Promise((function(r,n){if(t)if("activated"!==t.state)if("redundant"!==t.state){var i=function(){if("activated"===t.state)r(e);else{if("redundant"!==t.state)return;n(x.create("sw-reg-redundant"))}t.removeEventListener("statechange",i)};t.addEventListener("statechange",i)}else n(x.create("sw-reg-redundant"));else r(e);else n(x.create("no-sw-in-reg"))}))},r.prototype.getSWRegistration_=function(){var e=this;return this.registrationToUse?this.waitForRegistrationToActivate_(this.registrationToUse):(this.registrationToUse=null,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}).catch((function(e){throw x.create("failed-serviceworker-registration",{browserErrorMessage:e.message})})).then((function(t){return e.waitForRegistrationToActivate_(t).then((function(){return e.registrationToUse=t,t.update(),t}))})))},r.prototype.getPublicVapidKey_=function(){return n(this,void 0,void 0,(function(){return i(this,(function(e){return this.publicVapidKeyToUse?[2,this.publicVapidKeyToUse]:[2,j]}))}))},r.prototype.setupSWMessageListener_=function(){var e=this;navigator.serviceWorker.addEventListener("message",(function(t){if(t.data&&t.data[A.TYPE_OF_MSG]){var r=t.data;switch(r[A.TYPE_OF_MSG]){case D.PUSH_MSG_RECEIVED:case D.NOTIFICATION_CLICKED:var n=r[A.DATA];e.messageObserver&&e.messageObserver.next(n)}}}),!1)},r}(Y);function te(){return self&&"ServiceWorkerGlobalScope"in self?"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}Z={isSupported:te},_.INTERNAL.registerService("messaging",(function(e){if(!te())throw x.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new J(e):new ee(e)}),Z);var re="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function ne(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}var ie=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){e.exports=function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){if(!a&&ne)return ne();if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[s]={exports:{}};t[s][0].call(u.exports,(function(e){var r=t[s][1][e];return i(r||e)}),u,u.exports,e,t,r,n)}return r[s].exports}for(var o=ne,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){(function(e){var r,n,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var o=0,s=new i(f),a=e.document.createTextNode("");s.observe(a,{characterData:!0}),r=function(){a.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){f(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(f,0)};else{var c=new e.MessageChannel;c.port1.onmessage=f,r=function(){c.port2.postMessage(0)}}var u=[];function f(){var e,t;n=!0;for(var r=u.length;r;){for(t=u,u=[],e=-1;++e<r;)t[e]();r=u.length}n=!1}function d(e){1!==u.push(e)||n||r()}t.exports=d}).call(this,void 0!==re?re:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,r){var n=e(1);function i(){}var o={},s=["REJECTED"],a=["FULFILLED"],c=["PENDING"];function u(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==i&&h(this,e)}function f(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function d(e,t,r){n((function(){var n;try{n=t(r)}catch(t){return o.reject(e,t)}n===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,n)}))}function l(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var r=!1;function n(t){r||(r=!0,o.reject(e,t))}function i(t){r||(r=!0,o.resolve(e,t))}function s(){t(i,n)}var a=p(s);"error"===a.status&&n(a.value)}function p(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}function v(e){return e instanceof this?e:o.resolve(new this(i),e)}function b(e){var t=new this(i);return o.reject(t,e)}function g(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var s=new Array(r),a=0,c=-1,u=new this(i);++c<r;)f(e[c],c);return u;function f(e,i){function c(e){s[i]=e,++a!==r||n||(n=!0,o.resolve(u,s))}t.resolve(e).then(c,(function(e){n||(n=!0,o.reject(u,e))}))}}function m(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var s=-1,a=new this(i);++s<r;)c(e[s]);return a;function c(e){t.resolve(e).then((function(e){n||(n=!0,o.resolve(a,e))}),(function(e){n||(n=!0,o.reject(a,e))}))}}t.exports=u,u.prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===s)return this;var r=new this.constructor(i);return this.state!==c?d(r,this.state===a?e:t,this.outcome):this.queue.push(new f(r,e,t)),r},f.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},f.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},f.prototype.callRejected=function(e){o.reject(this.promise,e)},f.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},o.resolve=function(e,t){var r=p(l,t);if("error"===r.status)return o.reject(e,r.value);var n=r.value;if(n)h(e,n);else{e.state=a,e.outcome=t;for(var i=-1,s=e.queue.length;++i<s;)e.queue[i].callFulfilled(t)}return e},o.reject=function(e,t){e.state=s,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},u.resolve=v,u.reject=b,u.all=g,u.race=m},{1:1}],3:[function(e,t,r){(function(t){"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==re?re:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}var s=o();function a(){try{if(!s||!s.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}function c(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(i){if("TypeError"!==i.name)throw i;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)r.append(e[n]);return r.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var u=Promise;function f(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function d(e,t,r){"function"==typeof t&&e.then(t),"function"==typeof r&&e.catch(r)}function l(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function h(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var p="local-forage-detect-blob-support",v=void 0,b={},g=Object.prototype.toString,m="readonly",y="readwrite";function w(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),i=0;i<t;i++)n[i]=e.charCodeAt(i);return r}function k(e){return new u((function(t){var r=e.transaction(p,y),n=c([""]);r.objectStore(p).put(n,"key"),r.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},r.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);t(r||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}function S(e){return"boolean"==typeof v?u.resolve(v):k(e).then((function(e){return v=e}))}function _(e){var t=b[e.name],r={};r.promise=new u((function(e,t){r.resolve=e,r.reject=t})),t.deferredOperations.push(r),t.dbReady?t.dbReady=t.dbReady.then((function(){return r.promise})):t.dbReady=r.promise}function T(e){var t=b[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function M(e,t){var r=b[e.name].deferredOperations.pop();if(r)return r.reject(t),r.promise}function I(e,t){return new u((function(r,n){if(b[e.name]=b[e.name]||j(),e.db){if(!t)return r(e.db);_(e),e.db.close()}var i=[e.name];t&&i.push(e.version);var o=s.open.apply(s,i);t&&(o.onupgradeneeded=function(t){var r=o.result;try{r.createObjectStore(e.storeName),t.oldVersion<=1&&r.createObjectStore(p)}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),o.onerror=function(e){e.preventDefault(),n(o.error)},o.onsuccess=function(){var t=o.result;t.onversionchange=function(e){e.target.close()},r(t),T(e)}}))}function N(e){return I(e,!1)}function P(e){return I(e,!0)}function E(e,t){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,i=e.version>e.db.version;if(n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||r){if(r){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function O(e){return new u((function(t,r){var n=new FileReader;n.onerror=r,n.onloadend=function(r){var n=btoa(r.target.result||"");t({__local_forage_encoded_blob:!0,data:n,type:e.type})},n.readAsBinaryString(e)}))}function F(e){return c([w(atob(e.data))],{type:e.type})}function A(e){return e&&e.__local_forage_encoded_blob}function D(e){var t=this,r=t._initReady().then((function(){var e=b[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return d(r,e,e),r}function R(e){_(e);for(var t=b[e.name],r=t.forages,n=0;n<r.length;n++){var i=r[n];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return e.db=null,N(e).then((function(t){return e.db=t,E(e)?P(e):t})).then((function(n){e.db=t.db=n;for(var i=0;i<r.length;i++)r[i]._dbInfo.db=n})).catch((function(t){throw M(e,t),t}))}function x(e,t,r,n){void 0===n&&(n=1);try{var i=e.db.transaction(e.storeName,t);r(null,i)}catch(i){if(n>0&&(!e.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return u.resolve().then((function(){if(!e.db||"NotFoundError"===i.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),P(e)})).then((function(){return R(e).then((function(){x(e,t,r,n-1)}))})).catch(r);r(i)}}function j(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function C(e){var t=this,r={db:null};if(e)for(var n in e)r[n]=e[n];var i=b[r.name];i||(i=j(),b[r.name]=i),i.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=D);var o=[];function s(){return u.resolve()}for(var a=0;a<i.forages.length;a++){var c=i.forages[a];c!==t&&o.push(c._initReady().catch(s))}var f=i.forages.slice(0);return u.all(o).then((function(){return r.db=i.db,N(r)})).then((function(e){return r.db=e,E(r,t._defaultConfig.version)?P(r):e})).then((function(e){r.db=i.db=e,t._dbInfo=r;for(var n=0;n<f.length;n++){var o=f[n];o!==t&&(o._dbInfo.db=r.db,o._dbInfo.version=r.version)}}))}function B(e,t){var r=this;e=l(e);var n=new u((function(t,n){r.ready().then((function(){x(r._dbInfo,m,(function(i,o){if(i)return n(i);try{var s=o.objectStore(r._dbInfo.storeName).get(e);s.onsuccess=function(){var e=s.result;void 0===e&&(e=null),A(e)&&(e=F(e)),t(e)},s.onerror=function(){n(s.error)}}catch(e){n(e)}}))})).catch(n)}));return f(n,t),n}function W(e,t){var r=this,n=new u((function(t,n){r.ready().then((function(){x(r._dbInfo,m,(function(i,o){if(i)return n(i);try{var s=o.objectStore(r._dbInfo.storeName).openCursor(),a=1;s.onsuccess=function(){var r=s.result;if(r){var n=r.value;A(n)&&(n=F(n));var i=e(n,r.key,a++);void 0!==i?t(i):r.continue()}else t()},s.onerror=function(){n(s.error)}}catch(e){n(e)}}))})).catch(n)}));return f(n,t),n}function L(e,t,r){var n=this;e=l(e);var i=new u((function(r,i){var o;n.ready().then((function(){return o=n._dbInfo,"[object Blob]"===g.call(t)?S(o.db).then((function(e){return e?t:O(t)})):t})).then((function(t){x(n._dbInfo,y,(function(o,s){if(o)return i(o);try{var a=s.objectStore(n._dbInfo.storeName);null===t&&(t=void 0);var c=a.put(t,e);s.oncomplete=function(){void 0===t&&(t=null),r(t)},s.onabort=s.onerror=function(){var e=c.error?c.error:c.transaction.error;i(e)}}catch(e){i(e)}}))})).catch(i)}));return f(i,r),i}function U(e,t){var r=this;e=l(e);var n=new u((function(t,n){r.ready().then((function(){x(r._dbInfo,y,(function(i,o){if(i)return n(i);try{var s=o.objectStore(r._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){n(s.error)},o.onabort=function(){var e=s.error?s.error:s.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return f(n,t),n}function z(e){var t=this,r=new u((function(e,r){t.ready().then((function(){x(t._dbInfo,y,(function(n,i){if(n)return r(n);try{var o=i.objectStore(t._dbInfo.storeName).clear();i.oncomplete=function(){e()},i.onabort=i.onerror=function(){var e=o.error?o.error:o.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return f(r,e),r}function V(e){var t=this,r=new u((function(e,r){t.ready().then((function(){x(t._dbInfo,m,(function(n,i){if(n)return r(n);try{var o=i.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){r(o.error)}}catch(e){r(e)}}))})).catch(r)}));return f(r,e),r}function K(e,t){var r=this,n=new u((function(t,n){e<0?t(null):r.ready().then((function(){x(r._dbInfo,m,(function(i,o){if(i)return n(i);try{var s=o.objectStore(r._dbInfo.storeName),a=!1,c=s.openKeyCursor();c.onsuccess=function(){var r=c.result;r?0===e||a?t(r.key):(a=!0,r.advance(e)):t(null)},c.onerror=function(){n(c.error)}}catch(e){n(e)}}))})).catch(n)}));return f(n,t),n}function q(e){var t=this,r=new u((function(e,r){t.ready().then((function(){x(t._dbInfo,m,(function(n,i){if(n)return r(n);try{var o=i.objectStore(t._dbInfo.storeName).openKeyCursor(),s=[];o.onsuccess=function(){var t=o.result;t?(s.push(t.key),t.continue()):e(s)},o.onerror=function(){r(o.error)}}catch(e){r(e)}}))})).catch(r)}));return f(r,e),r}function G(e,t){t=h.apply(this,arguments);var r=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n,i=this;if(e.name){var o=e.name===r.name&&i._dbInfo.db?u.resolve(i._dbInfo.db):N(e).then((function(t){var r=b[e.name],n=r.forages;r.db=t;for(var i=0;i<n.length;i++)n[i]._dbInfo.db=t;return t}));n=e.storeName?o.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var r=t.version+1;_(e);var n=b[e.name],i=n.forages;t.close();for(var o=0;o<i.length;o++){var a=i[o];a._dbInfo.db=null,a._dbInfo.version=r}var c=new u((function(t,n){var i=s.open(e.name,r);i.onerror=function(e){i.result.close(),n(e)},i.onupgradeneeded=function(){i.result.deleteObjectStore(e.storeName)},i.onsuccess=function(){var e=i.result;e.close(),t(e)}}));return c.then((function(e){n.db=e;for(var t=0;t<i.length;t++){var r=i[t];r._dbInfo.db=e,T(r._dbInfo)}})).catch((function(t){throw(M(e,t)||u.resolve()).catch((function(){})),t}))}})):o.then((function(t){_(e);var r=b[e.name],n=r.forages;t.close();for(var i=0;i<n.length;i++)n[i]._dbInfo.db=null;var o=new u((function(t,r){var n=s.deleteDatabase(e.name);n.onerror=function(){var e=n.result;e&&e.close(),r(n.error)},n.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},n.onsuccess=function(){var e=n.result;e&&e.close(),t(e)}}));return o.then((function(e){r.db=e;for(var t=0;t<n.length;t++)T(n[t]._dbInfo)})).catch((function(t){throw(M(e,t)||u.resolve()).catch((function(){})),t}))}))}else n=u.reject("Invalid arguments");return f(n,t),n}var H={_driver:"asyncStorage",_initStorage:C,_support:a(),iterate:W,getItem:B,setItem:L,removeItem:U,clear:z,length:V,key:K,keys:q,dropInstance:G};function Q(){return"function"==typeof openDatabase}var Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",J="~~local_forage_type~",X=/^~~local_forage_type~([^~]+)~/,$="__lfsc__:",Z=$.length,ee="arbf",te="blob",re="si08",ne="ui08",ie="uic8",oe="si16",se="si32",ae="ur16",ce="ui32",ue="fl32",fe="fl64",de=Z+ee.length,le=Object.prototype.toString;function he(e){var t,r,n,i,o,s=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var u=new ArrayBuffer(s),f=new Uint8Array(u);for(t=0;t<a;t+=4)r=Y.indexOf(e[t]),n=Y.indexOf(e[t+1]),i=Y.indexOf(e[t+2]),o=Y.indexOf(e[t+3]),f[c++]=r<<2|n>>4,f[c++]=(15&n)<<4|i>>2,f[c++]=(3&i)<<6|63&o;return u}function pe(e){var t,r=new Uint8Array(e),n="";for(t=0;t<r.length;t+=3)n+=Y[r[t]>>2],n+=Y[(3&r[t])<<4|r[t+1]>>4],n+=Y[(15&r[t+1])<<2|r[t+2]>>6],n+=Y[63&r[t+2]];return r.length%3==2?n=n.substring(0,n.length-1)+"=":r.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}function ve(e,t){var r="";if(e&&(r=le.call(e)),e&&("[object ArrayBuffer]"===r||e.buffer&&"[object ArrayBuffer]"===le.call(e.buffer))){var n,i=$;e instanceof ArrayBuffer?(n=e,i+=ee):(n=e.buffer,"[object Int8Array]"===r?i+=re:"[object Uint8Array]"===r?i+=ne:"[object Uint8ClampedArray]"===r?i+=ie:"[object Int16Array]"===r?i+=oe:"[object Uint16Array]"===r?i+=ae:"[object Int32Array]"===r?i+=se:"[object Uint32Array]"===r?i+=ce:"[object Float32Array]"===r?i+=ue:"[object Float64Array]"===r?i+=fe:t(new Error("Failed to get type for BinaryArray"))),t(i+pe(n))}else if("[object Blob]"===r){var o=new FileReader;o.onload=function(){var r=J+e.type+"~"+pe(this.result);t($+te+r)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(r){console.error("Couldn't convert value into a JSON string: ",e),t(null,r)}}function be(e){if(e.substring(0,Z)!==$)return JSON.parse(e);var t,r=e.substring(de),n=e.substring(Z,de);if(n===te&&X.test(r)){var i=r.match(X);t=i[1],r=r.substring(i[0].length)}var o=he(r);switch(n){case ee:return o;case te:return c([o],{type:t});case re:return new Int8Array(o);case ne:return new Uint8Array(o);case ie:return new Uint8ClampedArray(o);case oe:return new Int16Array(o);case ae:return new Uint16Array(o);case se:return new Int32Array(o);case ce:return new Uint32Array(o);case ue:return new Float32Array(o);case fe:return new Float64Array(o);default:throw new Error("Unkown type: "+n)}}var ge={serialize:ve,deserialize:be,stringToBuffer:he,bufferToString:pe};function me(e,t,r,n){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,n)}function ye(e){var t=this,r={db:null};if(e)for(var n in e)r[n]="string"!=typeof e[n]?e[n].toString():e[n];var i=new u((function(e,n){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(e){return n(e)}r.db.transaction((function(i){me(i,r,(function(){t._dbInfo=r,e()}),(function(e,t){n(t)}))}),n)}));return r.serializer=ge,i}function we(e,t,r,n,i,o){e.executeSql(r,n,i,(function(e,s){s.code===s.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?o(e,s):me(e,t,(function(){e.executeSql(r,n,i,o)}),o)}),o):o(e,s)}),o)}function ke(e,t){var r=this;e=l(e);var n=new u((function(t,n){r.ready().then((function(){var i=r._dbInfo;i.db.transaction((function(r){we(r,i,"SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,r){var n=r.rows.length?r.rows.item(0).value:null;n&&(n=i.serializer.deserialize(n)),t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return f(n,t),n}function Se(e,t){var r=this,n=new u((function(t,n){r.ready().then((function(){var i=r._dbInfo;i.db.transaction((function(r){we(r,i,"SELECT * FROM "+i.storeName,[],(function(r,n){for(var o=n.rows,s=o.length,a=0;a<s;a++){var c=o.item(a),u=c.value;if(u&&(u=i.serializer.deserialize(u)),void 0!==(u=e(u,c.key,a+1)))return void t(u)}t()}),(function(e,t){n(t)}))}))})).catch(n)}));return f(n,t),n}function _e(e,t,r,n){var i=this;e=l(e);var o=new u((function(o,s){i.ready().then((function(){void 0===t&&(t=null);var a=t,c=i._dbInfo;c.serializer.serialize(t,(function(t,u){u?s(u):c.db.transaction((function(r){we(r,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){o(a)}),(function(e,t){s(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(n>0)return void o(_e.apply(i,[e,a,r,n-1]));s(t)}}))}))})).catch(s)}));return f(o,r),o}function Te(e,t,r){return _e.apply(this,[e,t,r,1])}function Me(e,t){var r=this;e=l(e);var n=new u((function(t,n){r.ready().then((function(){var i=r._dbInfo;i.db.transaction((function(r){we(r,i,"DELETE FROM "+i.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){n(t)}))}))})).catch(n)}));return f(n,t),n}function Ie(e){var t=this,r=new u((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){we(t,n,"DELETE FROM "+n.storeName,[],(function(){e()}),(function(e,t){r(t)}))}))})).catch(r)}));return f(r,e),r}function Ne(e){var t=this,r=new u((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){we(t,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],(function(t,r){var n=r.rows.item(0).c;e(n)}),(function(e,t){r(t)}))}))})).catch(r)}));return f(r,e),r}function Pe(e,t){var r=this,n=new u((function(t,n){r.ready().then((function(){var i=r._dbInfo;i.db.transaction((function(r){we(r,i,"SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,r){var n=r.rows.length?r.rows.item(0).key:null;t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return f(n,t),n}function Ee(e){var t=this,r=new u((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){we(t,n,"SELECT key FROM "+n.storeName,[],(function(t,r){for(var n=[],i=0;i<r.rows.length;i++)n.push(r.rows.item(i).key);e(n)}),(function(e,t){r(t)}))}))})).catch(r)}));return f(r,e),r}function Oe(e){return new u((function(t,r){e.transaction((function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(r,n){for(var i=[],o=0;o<n.rows.length;o++)i.push(n.rows.item(o).name);t({db:e,storeNames:i})}),(function(e,t){r(t)}))}),(function(e){r(e)}))}))}function Fe(e,t){t=h.apply(this,arguments);var r=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n,i=this;return n=e.name?new u((function(t){var n;n=e.name===r.name?i._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:n,storeNames:[e.storeName]}):t(Oe(n))})).then((function(e){return new u((function(t,r){e.db.transaction((function(n){function i(e){return new u((function(t,r){n.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){r(t)}))}))}for(var o=[],s=0,a=e.storeNames.length;s<a;s++)o.push(i(e.storeNames[s]));u.all(o).then((function(){t()})).catch((function(e){r(e)}))}),(function(e){r(e)}))}))})):u.reject("Invalid arguments"),f(n,t),n}var Ae={_driver:"webSQLStorage",_initStorage:ye,_support:Q(),iterate:Se,getItem:ke,setItem:Te,removeItem:Me,clear:Ie,length:Ne,key:Pe,keys:Ee,dropInstance:Fe};function De(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function Re(e,t){var r=e.name+"/";return e.storeName!==t.storeName&&(r+=e.storeName+"/"),r}function xe(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}function je(){return!xe()||localStorage.length>0}function Ce(e){var t=this,r={};if(e)for(var n in e)r[n]=e[n];return r.keyPrefix=Re(e,t._defaultConfig),je()?(t._dbInfo=r,r.serializer=ge,u.resolve()):u.reject()}function Be(e){var t=this,r=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,r=localStorage.length-1;r>=0;r--){var n=localStorage.key(r);0===n.indexOf(e)&&localStorage.removeItem(n)}}));return f(r,e),r}function We(e,t){var r=this;e=l(e);var n=r.ready().then((function(){var t=r._dbInfo,n=localStorage.getItem(t.keyPrefix+e);return n&&(n=t.serializer.deserialize(n)),n}));return f(n,t),n}function Le(e,t){var r=this,n=r.ready().then((function(){for(var t=r._dbInfo,n=t.keyPrefix,i=n.length,o=localStorage.length,s=1,a=0;a<o;a++){var c=localStorage.key(a);if(0===c.indexOf(n)){var u=localStorage.getItem(c);if(u&&(u=t.serializer.deserialize(u)),void 0!==(u=e(u,c.substring(i),s++)))return u}}}));return f(n,t),n}function Ue(e,t){var r=this,n=r.ready().then((function(){var t,n=r._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(n.keyPrefix.length)),t}));return f(n,t),n}function ze(e){var t=this,r=t.ready().then((function(){for(var e=t._dbInfo,r=localStorage.length,n=[],i=0;i<r;i++){var o=localStorage.key(i);0===o.indexOf(e.keyPrefix)&&n.push(o.substring(e.keyPrefix.length))}return n}));return f(r,e),r}function Ve(e){var t=this.keys().then((function(e){return e.length}));return f(t,e),t}function Ke(e,t){var r=this;e=l(e);var n=r.ready().then((function(){var t=r._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return f(n,t),n}function qe(e,t,r){var n=this;e=l(e);var i=n.ready().then((function(){void 0===t&&(t=null);var r=t;return new u((function(i,o){var s=n._dbInfo;s.serializer.serialize(t,(function(t,n){if(n)o(n);else try{localStorage.setItem(s.keyPrefix+e,t),i(r)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}}))}))}));return f(i,r),i}function Ge(e,t){if(t=h.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var n,i=this;return n=e.name?new u((function(t){e.storeName?t(Re(e,i._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var r=localStorage.key(t);0===r.indexOf(e)&&localStorage.removeItem(r)}})):u.reject("Invalid arguments"),f(n,t),n}var He={_driver:"localStorageWrapper",_initStorage:Ce,_support:De(),iterate:Le,getItem:We,setItem:qe,removeItem:Ke,clear:Be,length:Ve,key:Ue,keys:ze,dropInstance:Ge},Qe=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},Ye=function(e,t){for(var r=e.length,n=0;n<r;){if(Qe(e[n],t))return!0;n++}return!1},Je=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Xe={},$e={},Ze={INDEXEDDB:H,WEBSQL:Ae,LOCALSTORAGE:He},et=[Ze.INDEXEDDB._driver,Ze.WEBSQL._driver,Ze.LOCALSTORAGE._driver],tt=["dropInstance"],rt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(tt),nt={description:"",driver:et.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function it(e,t){e[t]=function(){var r=arguments;return e.ready().then((function(){return e[t].apply(e,r)}))}}function ot(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var r in t)t.hasOwnProperty(r)&&(Je(t[r])?arguments[0][r]=t[r].slice():arguments[0][r]=t[r])}return arguments[0]}var st=function(){function e(t){for(var r in i(this,e),Ze)if(Ze.hasOwnProperty(r)){var n=Ze[r],o=n._driver;this[r]=o,Xe[o]||this.defineDriver(n)}this._defaultConfig=ot({},nt),this._config=ot({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":n(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,r){var n=new u((function(t,r){try{var n=e._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void r(i);for(var o=rt.concat("_initStorage"),s=0,a=o.length;s<a;s++){var c=o[s];if((!Ye(tt,c)||e[c])&&"function"!=typeof e[c])return void r(i)}var d=function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),r=u.reject(t);return f(r,arguments[arguments.length-1]),r}},r=0,n=tt.length;r<n;r++){var i=tt[r];e[i]||(e[i]=t(i))}};d();var l=function(r){Xe[n]&&console.info("Redefining LocalForage driver: "+n),Xe[n]=e,$e[n]=r,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(l,r):l(!!e._support):l(!0)}catch(e){r(e)}}));return d(n,t,r),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,r){var n=Xe[e]?u.resolve(Xe[e]):u.reject(new Error("Driver not found."));return d(n,t,r),n},e.prototype.getSerializer=function(e){var t=u.resolve(ge);return d(t,e),t},e.prototype.ready=function(e){var t=this,r=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return d(r,e,e),r},e.prototype.setDriver=function(e,t,r){var n=this;Je(e)||(e=[e]);var i=this._getSupportedDrivers(e);function o(){n._config.driver=n.driver()}function s(e){return n._extend(e),o(),n._ready=n._initStorage(n._config),n._ready}function a(e){return function(){var t=0;function r(){for(;t<e.length;){var i=e[t];return t++,n._dbInfo=null,n._ready=null,n.getDriver(i).then(s).catch(r)}o();var a=new Error("No available storage method found.");return n._driverSet=u.reject(a),n._driverSet}return r()}}var c=null!==this._driverSet?this._driverSet.catch((function(){return u.resolve()})):u.resolve();return this._driverSet=c.then((function(){var e=i[0];return n._dbInfo=null,n._ready=null,n.getDriver(e).then((function(e){n._driver=e._driver,o(),n._wrapLibraryMethodsWithReady(),n._initDriver=a(i)}))})).catch((function(){o();var e=new Error("No available storage method found.");return n._driverSet=u.reject(e),n._driverSet})),d(this._driverSet,t,r),this._driverSet},e.prototype.supports=function(e){return!!$e[e]},e.prototype._extend=function(e){ot(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r];this.supports(i)&&t.push(i)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=rt.length;e<t;e++)it(this,rt[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),at=new st;t.exports=at},{3:3}]},{},[4])(4)})),oe=function(){function e(){this.listeners=null}return e.prototype.getListenerHandle=function(e,t){var r=this;if(this.listeners)for(var n=function(n){if(i.listeners[e][n]===t)return{value:{deregister:function(){return!!r.listeners&&(r.listeners[e].splice(n,1),!0)}}}},i=this,o=0;o<this.listeners[e].length;o++){var s=n(o);if("object"==typeof s)return s.value}},e.prototype.registerListener=function(e,t){var r,n=this;return null!==this.listeners?this.listeners[e]?this.listeners[e].push(t):this.listeners[e]=[t]:this.listeners=((r={})[e]=[t],r),{deregister:function(){if(n.listeners&&n.listeners[e])for(var r=0;r<n.listeners[e].length;r++)if(n.listeners[e][r]===t)return n.listeners[e].splice(r,1),!0;return!1}}},e.prototype.deregisterListener=function(e,t){var r=this.getListenerHandle(e,t);return!!r&&r.deregister()},e.prototype.emit=function(e,t){var r=this.listeners;r&&Object.keys(r).forEach((function(n){n===e&&r[e]&&r[e].forEach((function(e){e(t)}))}))},e}();function se(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.info.apply(null,e)}function ae(e){return e.split(" ").join("")}function ce(e,t){return n(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return[4,ie.setItem("".concat(e,"current_token"),t)];case 1:return r.sent(),[2]}}))}))}function ue(e){var t=e.browser,r=e.swPath;return"".concat(r).concat(t?"?browser=".concat(t):"")}function fe(e){return n(this,void 0,void 0,(function(){var t,r,n,o;return i(this,(function(i){switch(i.label){case 0:t=e.data,r=e.swPath,se(" navigator.serviceWorker.getRegistration","start"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,navigator.serviceWorker.getRegistration()];case 2:return n=i.sent(),se(" navigator.serviceWorker.getRegistration","complete"),se("registration",n),[3,4];case 3:return se("err get registration",i.sent()),[3,4];case 4:return se("navigator.serviceWorker.register","start"),[4,navigator.serviceWorker.register(ue({browser:t.browser,swPath:r}))];case 5:return o=i.sent(),se("navigator.serviceWorker.register","complete"),se("serviceWorkerRegistration.update","start"),[4,o.update()];case 6:return i.sent(),navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"AK_SW_MSG_ID",data:t}),se("serviceWorkerRegistration.update","complete"),se(o),[2,o]}}))}))}const de={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},le={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},he={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},pe={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},ve={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class be{static getFirstMatch(e,t){const r=t.match(e);return r&&r.length>0&&r[1]||""}static getSecondMatch(e,t){const r=t.match(e);return r&&r.length>1&&r[2]||""}static matchAndReturnConst(e,t,r){if(e.test(t))return r}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const t=e.split(".").splice(0,2).map((e=>parseInt(e,10)||0));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const t=e.split(".").splice(0,2).map((e=>parseInt(e,10)||0));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,t,r=!1){const n=be.getVersionPrecision(e),i=be.getVersionPrecision(t);let o=Math.max(n,i),s=0;const a=be.map([e,t],(e=>{const t=o-be.getVersionPrecision(e),r=e+new Array(t+1).join(".0");return be.map(r.split("."),(e=>new Array(20-e.length).join("0")+e)).reverse()}));for(r&&(s=o-Math.min(n,i)),o-=1;o>=s;){if(a[0][o]>a[1][o])return 1;if(a[0][o]===a[1][o]){if(o===s)return 0;o-=1}else if(a[0][o]<a[1][o])return-1}}static map(e,t){const r=[];let n;if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r}static find(e,t){let r,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,n=e.length;r<n;r+=1){const n=e[r];if(t(n,r))return n}}static assign(e,...t){const r=e;let n,i;if(Object.assign)return Object.assign(e,...t);for(n=0,i=t.length;n<i;n+=1){const e=t[n];if("object"==typeof e&&null!==e){Object.keys(e).forEach((t=>{r[t]=e[t]}))}}return e}static getBrowserAlias(e){return de[e]}static getBrowserTypeByAlias(e){return le[e]||""}}const ge=/version\/(\d+(\.?_?\d+)+)/i,me=[{test:[/googlebot/i],describe(e){const t={name:"Googlebot"},r=be.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||be.getFirstMatch(ge,e);return r&&(t.version=r),t}},{test:[/opera/i],describe(e){const t={name:"Opera"},r=be.getFirstMatch(ge,e)||be.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe(e){const t={name:"Opera"},r=be.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||be.getFirstMatch(ge,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe(e){const t={name:"Samsung Internet for Android"},r=be.getFirstMatch(ge,e)||be.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe(e){const t={name:"NAVER Whale Browser"},r=be.getFirstMatch(ge,e)||be.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe(e){const t={name:"MZ Browser"},r=be.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||be.getFirstMatch(ge,e);return r&&(t.version=r),t}},{test:[/focus/i],describe(e){const t={name:"Focus"},r=be.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||be.getFirstMatch(ge,e);return r&&(t.version=r),t}},{test:[/swing/i],describe(e){const t={name:"Swing"},r=be.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||be.getFirstMatch(ge,e);return r&&(t.version=r),t}},{test:[/coast/i],describe(e){const t={name:"Opera Coast"},r=be.getFirstMatch(ge,e)||be.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(e){const t={name:"Opera Touch"},r=be.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||be.getFirstMatch(ge,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe(e){const t={name:"Yandex Browser"},r=be.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||be.getFirstMatch(ge,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe(e){const t={name:"UC Browser"},r=be.getFirstMatch(ge,e)||be.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe(e){const t={name:"Maxthon"},r=be.getFirstMatch(ge,e)||be.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe(e){const t={name:"Epiphany"},r=be.getFirstMatch(ge,e)||be.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe(e){const t={name:"Puffin"},r=be.getFirstMatch(ge,e)||be.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe(e){const t={name:"Sleipnir"},r=be.getFirstMatch(ge,e)||be.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe(e){const t={name:"K-Meleon"},r=be.getFirstMatch(ge,e)||be.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe(e){const t={name:"WeChat"},r=be.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||be.getFirstMatch(ge,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe(e){const t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},r=be.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||be.getFirstMatch(ge,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe(e){const t={name:"Internet Explorer"},r=be.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe(e){const t={name:"Microsoft Edge"},r=be.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe(e){const t={name:"Microsoft Edge"},r=be.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe(e){const t={name:"Vivaldi"},r=be.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe(e){const t={name:"SeaMonkey"},r=be.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe(e){const t={name:"Sailfish"},r=be.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe(e){const t={name:"Amazon Silk"},r=be.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe(e){const t={name:"PhantomJS"},r=be.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe(e){const t={name:"SlimerJS"},r=be.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(e){const t={name:"BlackBerry"},r=be.getFirstMatch(ge,e)||be.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe(e){const t={name:"WebOS Browser"},r=be.getFirstMatch(ge,e)||be.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe(e){const t={name:"Bada"},r=be.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe(e){const t={name:"Tizen"},r=be.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||be.getFirstMatch(ge,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe(e){const t={name:"QupZilla"},r=be.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||be.getFirstMatch(ge,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe(e){const t={name:"Firefox"},r=be.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe(e){const t={name:"Electron"},r=be.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MiuiBrowser/i],describe(e){const t={name:"Miui"},r=be.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe(e){const t={name:"Chromium"},r=be.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||be.getFirstMatch(ge,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe(e){const t={name:"Chrome"},r=be.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe(e){const t={name:"Google Search"},r=be.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test(e){const t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe(e){const t={name:"Android Browser"},r=be.getFirstMatch(ge,e);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe(e){const t={name:"PlayStation 4"},r=be.getFirstMatch(ge,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe(e){const t={name:"Safari"},r=be.getFirstMatch(ge,e);return r&&(t.version=r),t}},{test:[/.*/i],describe(e){const t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:be.getFirstMatch(t,e),version:be.getSecondMatch(t,e)}}}];var ye=[{test:[/Roku\/DVP/],describe(e){const t=be.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:pe.Roku,version:t}}},{test:[/windows phone/i],describe(e){const t=be.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:pe.WindowsPhone,version:t}}},{test:[/windows /i],describe(e){const t=be.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),r=be.getWindowsVersionName(t);return{name:pe.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(e){const t={name:pe.iOS},r=be.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return r&&(t.version=r),t}},{test:[/macintosh/i],describe(e){const t=be.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),r=be.getMacOSVersionName(t),n={name:pe.MacOS,version:t};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe(e){const t=be.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:pe.iOS,version:t}}},{test(e){const t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe(e){const t=be.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),r=be.getAndroidVersionName(t),n={name:pe.Android,version:t};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe(e){const t=be.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),r={name:pe.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(e){const t=be.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||be.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||be.getFirstMatch(/\bbb(\d+)/i,e);return{name:pe.BlackBerry,version:t}}},{test:[/bada/i],describe(e){const t=be.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:pe.Bada,version:t}}},{test:[/tizen/i],describe(e){const t=be.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:pe.Tizen,version:t}}},{test:[/linux/i],describe:()=>({name:pe.Linux})},{test:[/CrOS/],describe:()=>({name:pe.ChromeOS})},{test:[/PlayStation 4/],describe(e){const t=be.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:pe.PlayStation4,version:t}}}],we=[{test:[/googlebot/i],describe:()=>({type:"bot",vendor:"Google"})},{test:[/huawei/i],describe(e){const t=be.getFirstMatch(/(can-l01)/i,e)&&"Nova",r={type:he.mobile,vendor:"Huawei"};return t&&(r.model=t),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:()=>({type:he.tablet,vendor:"Nexus"})},{test:[/ipad/i],describe:()=>({type:he.tablet,vendor:"Apple",model:"iPad"})},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:()=>({type:he.tablet,vendor:"Apple",model:"iPad"})},{test:[/kftt build/i],describe:()=>({type:he.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"})},{test:[/silk/i],describe:()=>({type:he.tablet,vendor:"Amazon"})},{test:[/tablet(?! pc)/i],describe:()=>({type:he.tablet})},{test(e){const t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe(e){const t=be.getFirstMatch(/(ipod|iphone)/i,e);return{type:he.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:()=>({type:he.mobile,vendor:"Nexus"})},{test:[/[^-]mobi/i],describe:()=>({type:he.mobile})},{test:e=>"blackberry"===e.getBrowserName(!0),describe:()=>({type:he.mobile,vendor:"BlackBerry"})},{test:e=>"bada"===e.getBrowserName(!0),describe:()=>({type:he.mobile})},{test:e=>"windows phone"===e.getBrowserName(),describe:()=>({type:he.mobile,vendor:"Microsoft"})},{test(e){const t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:()=>({type:he.tablet})},{test:e=>"android"===e.getOSName(!0),describe:()=>({type:he.mobile})},{test:e=>"macos"===e.getOSName(!0),describe:()=>({type:he.desktop,vendor:"Apple"})},{test:e=>"windows"===e.getOSName(!0),describe:()=>({type:he.desktop})},{test:e=>"linux"===e.getOSName(!0),describe:()=>({type:he.desktop})},{test:e=>"playstation 4"===e.getOSName(!0),describe:()=>({type:he.tv})},{test:e=>"roku"===e.getOSName(!0),describe:()=>({type:he.tv})}],ke=[{test:e=>"microsoft edge"===e.getBrowserName(!0),describe(e){if(/\sedg\//i.test(e))return{name:ve.Blink};const t=be.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:ve.EdgeHTML,version:t}}},{test:[/trident/i],describe(e){const t={name:ve.Trident},r=be.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:e=>e.test(/presto/i),describe(e){const t={name:ve.Presto},r=be.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test(e){const t=e.test(/gecko/i),r=e.test(/like gecko/i);return t&&!r},describe(e){const t={name:ve.Gecko},r=be.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(apple)?webkit\/537\.36/i],describe:()=>({name:ve.Blink})},{test:[/(apple)?webkit/i],describe(e){const t={name:ve.WebKit},r=be.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}}];class Se{constructor(e,t=!1){if(null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=be.find(me,(e=>{if("function"==typeof e.test)return e.test(this);if(e.test instanceof Array)return e.test.some((e=>this.test(e)));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=be.find(ye,(e=>{if("function"==typeof e.test)return e.test(this);if(e.test instanceof Array)return e.test.some((e=>this.test(e)));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:t}=this.getOS();return e?String(t).toLowerCase()||"":t||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:t}=this.getPlatform();return e?String(t).toLowerCase()||"":t||""}parsePlatform(){this.parsedResult.platform={};const e=be.find(we,(e=>{if("function"==typeof e.test)return e.test(this);if(e.test instanceof Array)return e.test.some((e=>this.test(e)));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=be.find(ke,(e=>{if("function"==typeof e.test)return e.test(this);if(e.test instanceof Array)return e.test.some((e=>this.test(e)));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return be.assign({},this.parsedResult)}satisfies(e){const t={};let r=0;const n={};let i=0;if(Object.keys(e).forEach((o=>{const s=e[o];"string"==typeof s?(n[o]=s,i+=1):"object"==typeof s&&(t[o]=s,r+=1)})),r>0){const e=Object.keys(t),r=be.find(e,(e=>this.isOS(e)));if(r){const e=this.satisfies(t[r]);if(void 0!==e)return e}const n=be.find(e,(e=>this.isPlatform(e)));if(n){const e=this.satisfies(t[n]);if(void 0!==e)return e}}if(i>0){const e=Object.keys(n),t=be.find(e,(e=>this.isBrowser(e,!0)));if(void 0!==t)return this.compareVersion(n[t])}}isBrowser(e,t=!1){const r=this.getBrowserName().toLowerCase();let n=e.toLowerCase();const i=be.getBrowserTypeByAlias(n);return t&&i&&(n=i.toLowerCase()),n===r}compareVersion(e){let t=[0],r=e,n=!1;const i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(r=e.substr(1),"="===e[1]?(n=!0,r=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?r=e.substr(1):"~"===e[0]&&(n=!0,r=e.substr(1)),t.indexOf(be.compareVersions(i,r,n))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,t=!1){return this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some((e=>this.is(e)))}}function _e(){if("userAgent"in window.navigator)return class{static getParser(e,t=!1){if("string"!=typeof e)throw new Error("UserAgent should be a string");return new Se(e,t)}static parse(e){return new Se(e).getResult()}static get BROWSER_MAP(){return le}static get ENGINE_MAP(){return ve}static get OS_MAP(){return pe}static get PLATFORMS_MAP(){return he}}.getParser(window.navigator.userAgent).getBrowser().name}function Te(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,ie.getItem("".concat(e,"current_token"))];case 1:return[2,t.sent()];case 2:return t.sent(),[2,null];case 3:return[2]}}))}))}function Me(e){localStorage.removeItem("".concat(e,"current_token"))}function Ie(e){return localStorage.getItem("".concat(e,"current_token"))}function Ne(){return n(this,void 0,void 0,(function(){var e,t,r;return i(this,(function(n){switch(n.label){case 0:return"showNotification"in ServiceWorkerRegistration.prototype?"denied"===Notification.permission?[3,8]:"PushManager"in window?(se("navigator.serviceWorker.ready","start"),[4,navigator.serviceWorker.ready]):[3,6]:(console.error("Notifications is not supported"),[2,!1]);case 1:e=n.sent(),se("navigator.serviceWorker.ready","complete"),se("serviceWorkerRegistration",e),n.label=2;case 2:return n.trys.push([2,4,,5]),se("serviceWorkerRegistration.pushManager.getSubscription","start"),[4,e.pushManager.getSubscription()];case 3:return t=n.sent(),se("serviceWorkerRegistration.pushManager.getSubscription","complete"),se("subscription",t),t?[3,5]:[2,!0];case 4:return r=n.sent(),console.error("Error on getting subscription data",r),[2,!1];case 5:return[3,7];case 6:return console.error("Push-notification is not supported by the browser"),[2,!1];case 7:return[3,9];case 8:case 9:return[2,!1]}}))}))}var Pe=Object.prototype.hasOwnProperty;function Ee(e,t){return"object"==typeof e&&Pe.call(e,t)}function Oe(e,t){if(t&&Ee(e,t)){var r=e[t];return!!Ee(r,"isFirebase")&&r.isFirebase}throw new Error("Invalid config")}var Fe={authSubdomain:"firebaseapp.com",bucketSubdomain:"appspot.com",dbSubdomain:"firebaseio.com"},Ae=function(){function e(e){if(this.config=e,this.events=new oe,this.browser=_e(),!this.browser)throw new Error("Can't detect browser")}return e.fetchSubscription=function(e){return n(this,void 0,void 0,(function(){var t,n,o,s,a,c,u,f,d,l,h,p,v,b;return i(this,(function(i){switch(i.label){case 0:switch(t=e.action,n=e.provider,o=e.subscription,s=e.match,a=e.update,c=e.customData,u=e.resourceToken,f=e.serverURL,d=e.serverSavePath,l=e.serverDeletePath,h=e.endpointOld,p=e.supOldSubscr,t){case"save":v=f+d;break;case"delete":v=f+l;break;default:throw new Error("Unknown ".concat(t))}i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(v,{method:"post",credentials:"include",body:JSON.stringify(r(r(r(r({},c||{}),{provider:n,endpoint:o.endpoint,resource_token:u,match:JSON.stringify(s||{}),update:JSON.stringify(a||{})}),h?{endpoint_old:h}:{}),p&&h?{sup_old_subscr:!0}:{}))})];case 2:return i.sent(),[3,4];case 3:return b=i.sent(),console.error("Can't post",t,b),[3,4];case 4:return[2]}}))}))},e.prototype.subscribePushManager=function(t){return n(this,void 0,void 0,(function(){var r,n,o,s,a,c,u,f;return i(this,(function(i){switch(i.label){case 0:return r=t.match,n=t.update,o=t.customData,se("navigator.serviceWorker.ready","start"),[4,navigator.serviceWorker.ready];case 1:s=i.sent(),se("navigator.serviceWorker.ready","complete"),se(s),i.label=2;case 2:return i.trys.push([2,6,,7]),se("serviceWorkerRegistration.pushManager.subscribe","start"),[4,s.pushManager.subscribe({userVisibleOnly:!0})];case 3:return a=i.sent(),se("serviceWorkerRegistration.pushManager.subscribe","complete"),se("subscription",a),c=ae(this.browser||""),u={browser:this.browser||"",provider:c,token:a.endpoint},se("fetchSubscription","start"),[4,e.fetchSubscription({action:"save",provider:c,subscription:a,match:r,update:n,customData:o,resourceToken:this.config.resourceToken,serverURL:this.config.serverURL,serverSavePath:this.config.serverSavePath,serverDeletePath:this.config.serverDeletePath})];case 4:return i.sent(),se("fetchSubscription","complete"),se("emit subscribe",u),this.events.emit("subscribe",u),se("saving subscription endpoint from push manager to cache",a.endpoint,"start"),[4,ce("".concat(e.RANDOM_PREFIX,"_endpoint_"),a.endpoint)];case 5:return i.sent(),se("saving subscription endpoint from push manager to cache",a.endpoint,"complete"),[3,7];case 6:return f=i.sent(),"denied"===Notification.permission||console.error("Unable to subscribe",f),[3,7];case 7:return[2]}}))}))},e.prototype.initialiseFirebaseNotification=function(t){return n(this,void 0,void 0,(function(){var r,o,s,a,c,u,f,d,l,h,p;return i(this,(function(v){switch(v.label){case 0:return r=t.match,o=t.update,s=t.customData,se("firebase.messaging().requestPermission","start"),[4,_.messaging().requestPermission()];case 1:return v.sent(),se("firebase.messaging().requestPermission","complete"),se("Notification.requestPermission","start"),[4,Notification.requestPermission()];case 2:if(a=v.sent(),se("Notification.requestPermission","complete"),se("notificationPermission",a),"granted"!==a)return[3,14];v.label=3;case 3:return v.trys.push([3,5,,6]),se("register service worker","start"),[4,fe({swPath:this.config.swPath||e.DEFAULT_SW_PATH,data:{browser:this.browser,resourceToken:this.config.resourceToken,shouldUseFirebase:Oe(this.config.browsers,this.browser),firebase:this.config.firebase,serverPushContentPath:this.config.serverPushContentPath,serverURL:this.config.serverURL}})];case 4:return c=v.sent(),se("register service worker","complete"),_.messaging().useServiceWorker(c),[3,6];case 5:return se("err register service worker",v.sent()),[3,6];case 6:return v.trys.push([6,12,,13]),se("firebase.messaging().getToken","start"),[4,_.messaging().getToken()];case 7:return u=v.sent(),se("firebase.messaging().getToken","complete"),se("get cached token","start"),[4,Te(e.RANDOM_PREFIX)];case 8:return se("get cached token","complete",f=v.sent()),se("Permission granted, token: ",u),f===u?[3,10]:(se("New token detected: ",u),d={endpoint:u||""},l="".concat(ae(this.browser||""),"Firebase"),h={browser:this.browser||"",provider:l,token:d.endpoint},[4,e.fetchSubscription({action:"save",provider:l,subscription:d,match:r,update:o,customData:s,resourceToken:this.config.resourceToken,serverURL:this.config.serverURL,serverSavePath:this.config.serverSavePath,serverDeletePath:this.config.serverDeletePath})]);case 9:v.sent(),this.events.emit("subscribe",h),v.label=10;case 10:return se("saving firebase token to cache",u,"start"),[4,ce(e.RANDOM_PREFIX,u||"")];case 11:return v.sent(),se("saving firebase token to cache",u,"complete"),[3,13];case 12:return p=v.sent(),console.error("Error occurred: ",p),[3,13];case 13:se("added firebase.messaging().onMessage handler"),_.messaging().onMessage((function(e){se("Message received:",e),function(e,t){n(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return[4,Notification.requestPermission()];case 1:return"granted"!==r.sent()?[3,4]:[4,navigator.serviceWorker.ready];case 2:return[4,r.sent().showNotification(e,t)];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}(e.notification.title,{body:e.notification.body,icon:e.notification.icon,image:e.notification.image,data:e.notification.click_action,actions:e.notification.actions})})),v.label=14;case 14:return[2]}}))}))},e.prototype.initialiseDefaultNotification=function(t){return n(this,void 0,void 0,(function(){var r,n,o,s;return i(this,(function(i){switch(i.label){case 0:return r=t.customData,n=t.match,o=t.update,"Opera"===this.browser||"Yandex Browser"===this.browser||"Samsung Internet for Android"===this.browser?(console.error("Only firebase supported"),[2]):(se("Initialise subscription for: ".concat(this.browser," without Firebase")),[4,fe({swPath:this.config.swPath||e.DEFAULT_SW_PATH,data:{browser:this.browser,resourceToken:this.config.resourceToken,shouldUseFirebase:Oe(this.config.browsers,this.browser),firebase:this.config.firebase,serverPushContentPath:this.config.serverPushContentPath,serverURL:this.config.serverURL}})]);case 1:return i.sent(),[4,Ne()];case 2:return s=i.sent(),se("checkSupportPushNotifications","complete"),se(s),s?(se("subscribePushManager","start"),[4,this.subscribePushManager({match:n,update:o,customData:r})]):[3,4];case 3:i.sent(),se("subscribePushManager","complete"),i.label=4;case 4:return[2]}}))}))},e.prototype.initialiseSafariNotification=function(e){return n(this,void 0,void 0,(function(){var t,r,n,o;return i(this,(function(i){return t=e.match,r=e.customData,n=e.update,se("Initialise subscription for: ".concat(this.browser," with Safari")),se("Permission data: ",o=window.safari.pushNotification.permission(this.config.browsers.Safari.websitePushID)),this.activateSafariPush({permissionData:o,match:t,update:n,cookieId:this.config.browsers.Safari.cookieId,customData:r}),[2]}))}))},e.prototype.activateSafariPush=function(e){var t=this,n=e.permissionData,i=e.match,o=e.update,s=e.cookieId,a=e.customData;switch(n.permission){case"default":window.safari.pushNotification.requestPermission(this.config.browsers.Safari.websitePushAPI,this.config.browsers.Safari.websitePushID,r(r({},a||{}),{resource_token:this.config.resourceToken,cookie_id:s,match:JSON.stringify(i||{}),update:JSON.stringify(o||{})}),(function(e){se("New permissionData: ",e),t.activateSafariPush({permissionData:e,match:i,update:o,cookieId:s,customData:a})}));break;case"denied":se("Denied subscription");break;case"granted":se("Approved subscription"),this.events.emit("subscribe",{browser:this.browser||"",provider:"Safari",token:n.deviceToken?n.deviceToken:null});break;default:console.error("Unexpected: ",n.permission)}},e.prototype.initialize=function(e){return n(this,void 0,void 0,(function(){var t,r,n;return i(this,(function(i){switch(i.label){case 0:if(t=e.match,r=e.update,n=e.customData,se("initialize akPush","start"),"default"!==Notification.permission)return[3,15];switch(this.browser){case"Chrome":case"Firefox":case"Yandex Browser":case"Samsung Internet for Android":case"Opera":return[3,1];case"Safari":return[3,11]}return[3,13];case 1:if(!("serviceWorker"in window.navigator))return[3,9];if(se("can use service worker"),!Oe(this.config.browsers,this.browser))return[3,6];se("should use firebase"),se('Initialise subscription for: "'.concat(this.browser,'" with Firebase'));try{se("firebase.initializeApp","start"),_.initializeApp({apiKey:this.config.firebase.apiKey,projectId:this.config.firebase.projectId,messagingSenderId:this.config.firebase.messagingSenderId,storageBucket:[this.config.firebase.projectId,Fe.bucketSubdomain].join("."),authDomain:[this.config.firebase.projectId,Fe.authSubdomain].join("."),databaseURL:[this.config.firebase.projectId,Fe.dbSubdomain].join(".")}),se("firebase.initializeApp","complete")}catch(e){se("err firebase.initializeApp",e)}i.label=2;case 2:return i.trys.push([2,4,,5]),se("activateFirebasePush","start"),[4,this.initialiseFirebaseNotification({match:t,update:r,customData:n})];case 3:return i.sent(),se("activateFirebasePush","complete"),se("initialize akPush","complete"),[3,5];case 4:return se("err with register, update or active firebase push",i.sent()),[3,5];case 5:return[3,8];case 6:return se("should not use firebase"),[4,this.initialiseDefaultNotification({match:t,update:r,customData:n})];case 7:i.sent(),se("initialize akPush","complete"),i.label=8;case 8:return[3,10];case 9:console.error("There is no serviceWorker"),i.label=10;case 10:return[3,14];case 11:return[4,this.initialiseSafariNotification({match:t,update:r,customData:n})];case 12:return i.sent(),se("initialize akPush","complete"),[3,14];case 13:return[2,void 0];case 14:return[3,16];case 15:se("initialize akPush","Notification permission is ",Notification.permission),i.label=16;case 16:return[2,void 0]}}))}))},e.prototype.initSubscription=function(e,t,r){return n(this,void 0,void 0,(function(){var o=this;return i(this,(function(s){switch(s.label){case 0:return"complete"!==document.readyState&&"interactive"!==document.readyState?[3,2]:[4,this.initialize({match:e||{},update:t||{},customData:r||{}})];case 1:return s.sent(),[3,3];case 2:window.addEventListener("load",(function(){return n(o,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,this.initialize({match:e||{},update:t||{},customData:r||{}})];case 1:return n.sent(),[2]}}))}))})),s.label=3;case 3:return[2]}}))}))},e.removeToken=function(t){return void 0===t&&(t=e.RANDOM_PREFIX),n(this,void 0,void 0,(function(){var e,r,n,o;return i(this,(function(i){switch(i.label){case 0:return e=Ie(t),[4,Te(t)];case 1:return r=i.sent(),n=Ie("".concat(t,"_endpoint_")),[4,Te("".concat(t,"_endpoint_"))];case 2:if(o=i.sent(),e&&Me(t),n&&Me("".concat(t,"_endpoint_")),!r)return[3,6];i.label=3;case 3:return i.trys.push([3,5,,6]),[4,ie.removeItem("".concat(t,"current_token"))];case 4:return i.sent(),[2,{result:"success"}];case 5:return[2,{result:"error",error:i.sent()}];case 6:if(!o)return[3,10];i.label=7;case 7:return i.trys.push([7,9,,10]),[4,ie.removeItem("".concat(t,"_endpoint_"))];case 8:return i.sent(),[2,{result:"success"}];case 9:return[2,{result:"error",error:i.sent()}];case 10:return[2,{result:"not-found"}]}}))}))},e.RANDOM_PREFIX="Shahkoop2aeleiv8Ierief_",e.DEFAULT_SW_PATH="/service-worker.js",e}();module.exports=Ae;
//# sourceMappingURL=AKPush.js.map
