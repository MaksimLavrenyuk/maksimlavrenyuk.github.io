!function(){function t(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}})),e.default=t,Object.freeze(e)}window.require="function"==typeof require?function(t,e){var r=e.querySelector("script[data-main]");return r&&t(r.dataset.main),t}(require,document):function(t){var e=/,[ ]*/gim;function r(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(),e}return function(){var n={},i=function(){var r,n=t.head,i=t.querySelector("script[data-scripts]"),o=t.querySelector("script[data-styles]"),s=o?o.dataset.styles:"",a=i?i.dataset.scripts:"",c=t.querySelector("script[data-base_dir]"),u=c&&c.dataset.base_dir;return u=u&&"string"==typeof u?u:"./",(u=new URL(u,location.href).href)&&((r=t.createElement("base")).setAttribute("href",u),n.append(r)),"string"==typeof s&&s.trim().replace(e,",").split(",").forEach((function(e){(r=t.createElement("link")).setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href",e.trim()),n.append(r)})),"string"==typeof a&&a.trim().replace(e,",").split(",").forEach((function(e){(r=t.createElement("script")).setAttribute("type","text/javascript"),r.setAttribute("src",e.trim()),n.append(r)})),u}(),o=t.querySelector("script[data-main]"),s=o?o.dataset.main:null;function a(t,e){e="string"==typeof e?e.trim():"";var i=new URL(e,t);i.pathname=function(t){if((t="string"==typeof t?t:"").indexOf(".")<0){var e=r("".concat(t,"/package.json"));200===e.status&&(t=t+"/"+JSON.parse(e.responseText).main)}return t}(i.pathname),t=i.href.substr(0,i.href.lastIndexOf("/")+1);var o=i.pathname.substr(i.pathname.lastIndexOf("/")+1);if(n.hasOwnProperty(i.href))return n[i.href];var s=r(i.href);if(200===s.status){var c={};return/(.json)$/gi.test(o)?c.exports=JSON.parse(s.responseText):(c.exports={},new Function("exports","require","module","__filename","__dirname","\n              ".concat(s.responseText,"\n              //# sourceURL=").concat(i.href,"\n            ")).call(this,c.exports,a.bind(this,t),c,o,t),n[i.href]=c.exports),c.exports}}Object.defineProperty(a,"modules",{set:Function.prototype,get:function(){return n}});var c=a.bind(this,i);return s&&window.addEventListener("load",c.bind(this,new URL(s,i).href)),c}()}(document);var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},e(t,r)};function r(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},n.apply(this,arguments)};function i(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r}function o(t,e,r,n){return new(r||(r=Promise))((function(i,o){function s(t){try{c(n.next(t))}catch(t){o(t)}}function a(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))}function s(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function a(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function c(t,e,r){if(r||2===arguments.length)for(var n,i=0,o=e.length;i<o;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}var u,l=function(){function t(){this.listeners=null}return t.prototype.getListenerHandle=function(t,e){var r=this;if(this.listeners)for(var n=function(n){if(i.listeners[t][n]===e)return{value:{deregister:function(){return!!r.listeners&&(r.listeners[t].splice(n,1),!0)}}}},i=this,o=0;o<this.listeners[t].length;o++){var s=n(o);if("object"==typeof s)return s.value}},t.prototype.registerListener=function(t,e){var r,n=this;return null!==this.listeners?this.listeners[t]?this.listeners[t].push(e):this.listeners[t]=[e]:this.listeners=((r={})[t]=[e],r),{deregister:function(){if(n.listeners&&n.listeners[t])for(var r=0;r<n.listeners[t].length;r++)if(n.listeners[t][r]===e)return n.listeners[t].splice(r,1),!0;return!1}}},t.prototype.deregisterListener=function(t,e){var r=this.getListenerHandle(t,e);return!!r&&r.deregister()},t.prototype.emit=function(t,e){var r=this.listeners;r&&Object.keys(r).forEach((function(n){n===t&&r[t]&&r[t].forEach((function(t){t(e)}))}))},t}();!function(t){t.connect="connect",t.disconnect="disconnect",t.init="init",t.act="act",t.ping="ping"}(u||(u={}));var h=function(){function t(t){this.isDebug="debug"===t.mode,this.connectState={loading:!1,error:!1},this.pingState=[],this.actAccumulator=[],this.actListener=this.actListener.bind(this),this.actManager=t.manager,this.variableStorage=t.variableStorage,this.events=new l}return t.createDebugMsgInit=function(){return{type:u.init}},t.createDebugMsgPing=function(){return{type:u.ping}},t.createDebugMsgDisconnect=function(){return{type:u.disconnect}},t.isPingMsg=function(t){return t.type===u.ping},t.isDisconnectMsg=function(t){return t.type===u.disconnect},t.isConnectMsg=function(t){return t.type===u.connect},t.prototype.start=function(){this.isDebug&&(this.spy(),this.connect())},t.prototype.emitInit=function(){this.events.emit("msg",t.createDebugMsgInit())},t.prototype.emitPing=function(){this.events.emit("msg",t.createDebugMsgPing())},t.prototype.emitDisconnect=function(){this.events.emit("msg",t.createDebugMsgDisconnect())},t.prototype.emitAction=function(t){this.events.emit("msg",this.createDebugMsgAct(t))},t.prototype.createDebugMsgAct=function(t){return{type:u.act,data:{act:t,variables:this.variableStorage.readVariables()}}},t.prototype.setConnectState=function(t){this.connectState=n(n({},this.connectState),t)},t.prototype.addPing=function(t){this.pingState.push(t)},t.prototype.checkPing=function(){if(this.pingState.length<t.PING_CHECK_SIZE)return!0;for(var e=this.pingState.length-1;e>this.pingState.length-1-t.PING_CHECK_SIZE;e--){var r=this.pingState[e];if(null!==r&&!r.error)return!0}return!1},t.prototype.actListener=function(t){this.connectState.loading?this.actAccumulator.push(t):this.emitAction(t)},t.prototype.cleanActAccumulator=function(){var t=this;this.actAccumulator.forEach((function(e){t.emitAction(e)})),this.actAccumulator.length=0},t.prototype.spy=function(){this.actManager.events.registerListener("act",this.actListener)},t.prototype.spyPing=function(){var e=this,r=0,n=setInterval((function(){e.emitPing(),r+=1,setTimeout((function(){void 0===e.pingState[r-1]&&e.addPing(null),e.checkPing()||(clearInterval(n),e.disconnect())}),t.PING_CHECK_TIME)}),t.PING_INTERVAL)},t.prototype.pingListener=function(){this.addPing({error:!1})},t.prototype.message=function(e){t.isConnectMsg(e)?(this.setConnectState({loading:!1}),this.cleanActAccumulator(),this.spyPing()):t.isPingMsg(e)?this.pingListener():t.isDisconnectMsg(e)&&this.disconnect()},t.prototype.disconnect=function(){this.setConnectState({loading:!1,error:!0}),this.emitDisconnect()},t.prototype.connect=function(){var e=this;this.setConnectState({loading:!0}),this.emitInit(),setTimeout((function(){e.connectState.loading&&e.disconnect()}),t.CONNECT_TIMEOUT)},t.PING_INTERVAL=5e3,t.PING_CHECK_TIME=1e3,t.PING_CHECK_SIZE=5,t.CONNECT_TIMEOUT=1e4,t}(),f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},p=function(t,e){if(e=e.split(":")[0],!(t=+t))return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t},d=Object.prototype.hasOwnProperty;function m(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}function v(t){try{return encodeURIComponent(t)}catch(t){return null}}var g={stringify:function(t,e){e=e||"";var r,n,i=[];for(n in"string"!=typeof e&&(e="?"),t)if(d.call(t,n)){if((r=t[n])||null!=r&&!isNaN(r)||(r=""),n=v(n),r=v(r),null===n||null===r)continue;i.push(n+"="+r)}return i.length?e+i.join("&"):""},parse:function(t){for(var e,r=/([^=?#&]+)=?([^&]*)/g,n={};e=r.exec(t);){var i=m(e[1]),o=m(e[2]);null===i||null===o||i in n||(n[i]=o)}return n}},y=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,w=/[\n\r\t]/g,b=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,S=/:\d+$/,E=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,I=/^[a-zA-Z]:/;function C(t){return(t||"").toString().replace(y,"")}var T=[["#","hash"],["?","query"],function(t,e){return k(e.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],L={hash:1,query:1};function R(t){var e,r=("undefined"!=typeof window?window:void 0!==f?f:"undefined"!=typeof self?self:{}).location||{},n={},i=typeof(t=t||r);if("blob:"===t.protocol)n=new x(unescape(t.pathname),{});else if("string"===i)for(e in n=new x(t,{}),L)delete n[e];else if("object"===i){for(e in t)e in L||(n[e]=t[e]);void 0===n.slashes&&(n.slashes=b.test(t.href))}return n}function k(t){return"file:"===t||"ftp:"===t||"http:"===t||"https:"===t||"ws:"===t||"wss:"===t}function D(t,e){t=(t=C(t)).replace(w,""),e=e||{};var r,n=E.exec(t),i=n[1]?n[1].toLowerCase():"",o=!!n[2],s=!!n[3],a=0;return o?s?(r=n[2]+n[3]+n[4],a=n[2].length+n[3].length):(r=n[2]+n[4],a=n[2].length):s?(r=n[3]+n[4],a=n[3].length):r=n[4],"file:"===i?a>=2&&(r=r.slice(2)):k(i)?r=n[4]:i?o&&(r=r.slice(2)):a>=2&&k(e.protocol)&&(r=n[4]),{protocol:i,slashes:o||k(i),slashesCount:a,rest:r}}function x(t,e,r){if(t=(t=C(t)).replace(w,""),!(this instanceof x))return new x(t,e,r);var n,i,o,s,a,c,u=T.slice(),l=typeof e,h=this,f=0;for("object"!==l&&"string"!==l&&(r=e,e=null),r&&"function"!=typeof r&&(r=g.parse),n=!(i=D(t||"",e=R(e))).protocol&&!i.slashes,h.slashes=i.slashes||n&&e.slashes,h.protocol=i.protocol||e.protocol||"",t=i.rest,("file:"===i.protocol&&(2!==i.slashesCount||I.test(t))||!i.slashes&&(i.protocol||i.slashesCount<2||!k(h.protocol)))&&(u[3]=[/(.*)/,"pathname"]);f<u.length;f++)"function"!=typeof(s=u[f])?(o=s[0],c=s[1],o!=o?h[c]=t:"string"==typeof o?~(a="@"===o?t.lastIndexOf(o):t.indexOf(o))&&("number"==typeof s[2]?(h[c]=t.slice(0,a),t=t.slice(a+s[2])):(h[c]=t.slice(a),t=t.slice(0,a))):(a=o.exec(t))&&(h[c]=a[1],t=t.slice(0,a.index)),h[c]=h[c]||n&&s[3]&&e[c]||"",s[4]&&(h[c]=h[c].toLowerCase())):t=s(t,h);r&&(h.query=r(h.query)),n&&e.slashes&&"/"!==h.pathname.charAt(0)&&(""!==h.pathname||""!==e.pathname)&&(h.pathname=function(t,e){if(""===t)return e;for(var r=(e||"/").split("/").slice(0,-1).concat(t.split("/")),n=r.length,i=r[n-1],o=!1,s=0;n--;)"."===r[n]?r.splice(n,1):".."===r[n]?(r.splice(n,1),s++):s&&(0===n&&(o=!0),r.splice(n,1),s--);return o&&r.unshift(""),"."!==i&&".."!==i||r.push(""),r.join("/")}(h.pathname,e.pathname)),"/"!==h.pathname.charAt(0)&&k(h.protocol)&&(h.pathname="/"+h.pathname),p(h.port,h.protocol)||(h.host=h.hostname,h.port=""),h.username=h.password="",h.auth&&(~(a=h.auth.indexOf(":"))?(h.username=h.auth.slice(0,a),h.username=encodeURIComponent(decodeURIComponent(h.username)),h.password=h.auth.slice(a+1),h.password=encodeURIComponent(decodeURIComponent(h.password))):h.username=encodeURIComponent(decodeURIComponent(h.auth)),h.auth=h.password?h.username+":"+h.password:h.username),h.origin="file:"!==h.protocol&&k(h.protocol)&&h.host?h.protocol+"//"+h.host:"null",h.href=h.toString()}x.prototype={set:function(t,e,r){var n=this;switch(t){case"query":"string"==typeof e&&e.length&&(e=(r||g.parse)(e)),n[t]=e;break;case"port":n[t]=e,p(e,n.protocol)?e&&(n.host=n.hostname+":"+e):(n.host=n.hostname,n[t]="");break;case"hostname":n[t]=e,n.port&&(e+=":"+n.port),n.host=e;break;case"host":n[t]=e,S.test(e)?(e=e.split(":"),n.port=e.pop(),n.hostname=e.join(":")):(n.hostname=e,n.port="");break;case"protocol":n.protocol=e.toLowerCase(),n.slashes=!r;break;case"pathname":case"hash":if(e){var i="pathname"===t?"/":"#";n[t]=e.charAt(0)!==i?i+e:e}else n[t]=e;break;case"username":case"password":n[t]=encodeURIComponent(e);break;case"auth":var o=e.indexOf(":");~o?(n.username=e.slice(0,o),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=e.slice(o+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(e))}for(var s=0;s<T.length;s++){var a=T[s];a[4]&&(n[a[1]]=n[a[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin="file:"!==n.protocol&&k(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n},toString:function(t){t&&"function"==typeof t||(t=g.stringify);var e,r=this,n=r.host,i=r.protocol;i&&":"!==i.charAt(i.length-1)&&(i+=":");var o=i+(r.protocol&&r.slashes||k(r.protocol)?"//":"");return r.username?(o+=r.username,r.password&&(o+=":"+r.password),o+="@"):r.password?(o+=":"+r.password,o+="@"):"file:"!==r.protocol&&k(r.protocol)&&!n&&"/"!==r.pathname&&(o+="@"),(":"===n[n.length-1]||S.test(r.hostname)&&!r.port)&&(n+=":"),o+=n+r.pathname,(e="object"==typeof r.query?t(r.query):r.query)&&(o+="?"!==e.charAt(0)?"?"+e:e),r.hash&&(o+=r.hash),o}},x.extractProtocol=D,x.location=R,x.trimLeft=C,x.qs=g;var P=x,U="actm-";var A,H,_,q="Function.prototype.bind called on incompatible ",F=Array.prototype.slice,M=Object.prototype.toString,N="[object Function]",O=Function.prototype.bind||function(t){var e=this;if("function"!=typeof e||M.call(e)!==N)throw new TypeError(q+e);for(var r,n=F.call(arguments,1),i=function(){if(this instanceof r){var i=e.apply(this,n.concat(F.call(arguments)));return Object(i)===i?i:this}return e.apply(t,n.concat(F.call(arguments)))},o=Math.max(0,e.length-n.length),s=[],a=0;a<o;a++)s.push("$"+a);if(r=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")(i),e.prototype){var c=function(){};c.prototype=e.prototype,r.prototype=new c,c.prototype=null}return r},W=O.call(Function.call,Object.prototype.hasOwnProperty),V=0,j=function(){function t(t,e){this.strId=t.strId,this.firingOption=t.firingOption,this.priority=t.priority||V,this.period=t.period,this.before=t.before,this.after=t.after,this.triggers=t.triggers,this.tag=t.tag,this.deps=e}return t.sortInstructionsByPriority=function(t){for(var e=c([],a(t),!1),r=1;r<e.length;r++){for(var n=e[r],i=r-1;i>-1&&e[i].priority<n.priority;)e[i+1]=e[i],i-=1;e[i+1]=n}return e},t.prototype.checkPeriod=function(){if(void 0===this.period)return!0;if(this.period){var t=Number(new Date(this.period.start)),e=Number(new Date(this.period.end)),r=Number(new Date);return t<=r&&r<=e}return!1},t.prototype.act=function(t){return!!t||this.checkPeriod()},t.prototype.run=function(t){return o(this,void 0,void 0,(function(){var e,r;return s(this,(function(n){switch(n.label){case 0:return(e=this.act(t))?[4,null==(r=this.deps.tagStorage.tag(this.tag))?void 0:r.run()]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2,e]}}))}))},t}(),z=function(){function t(t){this.instructionStorage=t.deps.instructionStorage}return t.prototype.visit=function(t,e,r){return o(this,void 0,void 0,(function(){var n,i;return s(this,(function(o){switch(o.label){case 0:return void 0===t?[2]:((null==t?void 0:t.before)&&(n=this.instructionStorage.instruction(t.before)),(null==t?void 0:t.after)&&(i=this.instructionStorage.instruction(t.after)),[4,this.visit(n,e,r)]);case 1:return o.sent(),[4,r(t,t===e)];case 2:return o.sent(),[4,this.visit(i,e,r)];case 3:return o.sent(),[2]}}))}))},t.prototype.walk=function(t,e){return o(this,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return[4,this.visit(t,t,e)];case 1:return r.sent(),[2]}}))}))},t}();function B(t){return Object.keys(t)}function G(t,e){return"object"==typeof t&&null!==t&&W(t,e)}!function(t){t.Click="click",t.ClickLink="click_link",t.GroupTrigger="group_trigger",t.Custom="custom",t.ViewPage="view_page",t.DomReady="dom_ready",t.DomElementVisible="dom_element_visible",t.Initialization="initialization",t.WindowLoaded="window_loaded",t.ScrollingDepth="scrolling_depth",t.SubmitForm="submit_form",t.ChangeHistory="change_history",t.JSError="js_error",t.Timer="timer"}(A||(A={})),function(t){t.oncePerEvent="once_per_event",t.oncePerPage="once_per_page",t.noRestrictions="no_restrictions"}(H||(H={})),function(t){t.equals="equals",t.notEquals="not_equals",t.contains="contains",t.notContains="not_contains",t.startsWith="starts_with",t.notStartsWith="not_starts_with",t.endsWith="ends_with",t.notEndsWith="not_ends_with",t.matchCssSelector="match_css_selector",t.notMatchCssSelector="not_match_css_selector",t.less="less",t.lessOrEquals="less_or_equals",t.greater="greater",t.greaterOrEquals="greater_or_equals"}(_||(_={}));var J,K=function(t){this.event=t.event};function $(t){return"".concat(U).concat(t)}!function(t){t.DomElement="domElement",t.CustomVariable="customVariable",t.URL="Url",t.URLReferrer="UrlReferrer",t.JSVariable="JSVariable",t.JSCode="JSCode",t.Cookie="Cookie",t.ElementVisible="ElementVisible",t.Utm="Utm"}(J||(J={}));var Y,Z=J;!function(t){t.visibleRatio="visibleRatio",t.visibleTime="visibleTime",t.newUrl="newUrl",t.oldUrl="oldUrl",t.newUrlFragment="newUrlFragment",t.oldUrlFragment="oldUrlFragment",t.historyChangeSource="historyChangeSource",t.elementId="elementId",t.elementClasses="elementClasses",t.element="element",t.elementTarget="elementTarget",t.elementUrl="elementUrl",t.elementText="elementText",t.errorMessage="errorMessage",t.formId="formId",t.formClasses="formClasses",t.formElement="formElement",t.formTarget="formTarget",t.formUrl="formUrl",t.formText="formText",t.errorUrl="errorUrl",t.errorLine="errorLine",t.scrollThreshold="scrollThreshold",t.scrollUnits="scrollUnits",t.scrollDirection="scrollDirection",t.timerCurrentTime="timerCurrentTime",t.timerElapsedTime="timerElapsedTime",t.timerEventNumber="timerEventNumber",t.timerInterval="timerInterval",t.timerLimit="timerLimit",t.timerStartTime="timerStartTime",t.timerEventName="timerEventName",t.start="start"}(Y||(Y={}));var Q=function(){function t(t){this.data=[],this.events=new l,this.variableStorage=t.variableStorage}return t.isInputEvent=function(t){return Boolean(t.event)},t.isEvent=function(t){return Boolean(t.event)},t.isEventKey=function(t,e){return"event"===t&&"string"==typeof e},t.prototype.formattingInputItem=function(e){var r;return t.isInputEvent(e)?n(n({},e),((r={})[t.ID_FIELD]=this.getLastEventId()+1,r)):e},t.prototype.formattingEvent=function(e){var r;return n(n({},e),((r={})[t.ID_FIELD]=this.getLastEventId()+1,r))},t.prototype.addOutsideItem=function(){for(var e=this,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var o=[];r.forEach((function(r){var n=B(r),s=null;n.forEach((function(n){var a=r[n];if(t.isEventKey(n,a)&&null===s){r.event;var c=i(r,["event"]);s=new K({event:a}),B(c).forEach((function(t){s&&(s[t]=c[t])})),o.push(s)}else e.variableStorage.add(Z.CustomVariable,"".concat(n),a)})),e.pushInputItem(r)})),o.forEach((function(t){e.events.emit("outsideEvent",t)}))},t.prototype.pushInputItem=function(t){this.data.push(this.formattingInputItem(t)),this.events.emit("updateData",this.data[this.data.length-1])},t.prototype.pushInsideEvent=function(t){this.data.push(this.formattingEvent(t)),this.events.emit("updateData",this.data[this.data.length-1])},t.prototype.addInsideItem=function(t){this.pushInsideEvent(t)},t.prototype.getLastEventId=function(){for(var e=this.data.length-1;e>-1;e--){var r=this.data[e];if(r&&t.isEvent(r)&&t.isEvent(r))return r[t.ID_FIELD]}return 0},t.ID_FIELD=$("eventId"),t}();var X={id:function(t){return"#"+t},className:function(t){return"."+t},url:function(t){return'[href="'+t+'"]'},target:function(t){return'[target="'+t+'"]'}},tt={id:function(t){return'[id*="'+t+'"]'},className:function(t){return'[class*="'+t+'"]'},url:function(t){return'[href*="'+t+'"]'},target:function(t){return'[target*="'+t+'"]'}},et={id:function(t){return'[id^="'+t+'"]'},className:function(t){return'[class^="'+t+'"]'},url:function(t){return'[href^="'+t+'"]'},target:function(t){return'[target^="'+t+'"]'}},rt={id:function(t){return'[id$="'+t+'"]'},className:function(t){return'[class$="'+t+'"]'},url:function(t){return'[href$="'+t+'"]'},target:function(t){return'[target$="'+t+'"]'}};function nt(t,e,r){return t.closest(X[e](r))}function it(t,e,r){return t.closest(tt[e](r))}function ot(t,e,r){return t.closest(et[e](r))}function st(t,e,r){return t.closest(rt[e](r))}function at(t,e){return t.closest(e)}function ct(t,e){return""!==e&&String(t).trim().includes(e)}function ut(t,e){return""!==e&&!String(t).trim().includes(e)}function lt(t,e){return""!==e&&new RegExp("^".concat(e)).test(String(t).trim())}function ht(t,e){return""!==e&&!new RegExp("^".concat(e)).test(String(t).trim())}function ft(t,e){return""!==e&&new RegExp("".concat(e,"$")).test(String(t).trim())}function pt(t,e){return""!==e&&!new RegExp("".concat(e,"$")).test(String(t).trim())}var dt={id:function(t,e){return t.id.trim()===e},className:function(t,e){return t.className===e},url:function(t,e){return t instanceof HTMLFormElement&&t.action===e},target:function(t,e){return t instanceof HTMLFormElement&&t.target===e}},mt={id:function(t,e){return ct(t.id,e)},className:function(t,e){return ct(t.className,e)},url:function(t,e){return t instanceof HTMLFormElement&&ct(t.action,e)},target:function(t,e){return t instanceof HTMLFormElement&&ct(t.target,e)}},vt={id:function(t,e){return lt(t.id,e)},className:function(t,e){return lt(t.className,e)},url:function(t,e){return t instanceof HTMLFormElement&&lt(t.action,e)},target:function(t,e){return t instanceof HTMLFormElement&&lt(t.target,e)}},gt={id:function(t,e){return ft(t.id,e)},className:function(t,e){return ft(t.className,e)},url:function(t,e){return t instanceof HTMLFormElement&&ft(t.action,e)},target:function(t,e){return t instanceof HTMLFormElement&&ft(t.target,e)}};function yt(t,e,r){return dt[e](t,r)}function wt(t,e,r){return mt[e](t,r)}function bt(t,e,r){return vt[e](t,r)}function St(t,e,r){return gt[e](t,r)}function Et(t,e){for(var r=document.querySelectorAll(e),n=0;n<r.length;n++)if(r[n]===t)return!0;return!1}function It(t,e){return t instanceof HTMLElement&&null!==t.textContent&&t.textContent.trim()===e}function Ct(t,e){return t instanceof HTMLElement&&null!==t.textContent&&(""!==e&&t.textContent.trim().includes(e))}function Tt(t,e){return t instanceof HTMLElement&&null!==t.textContent&&(""!==e&&new RegExp("^".concat(e)).test(t.textContent.trim()))}function Lt(t,e){return t instanceof HTMLElement&&null!==t.textContent&&(""!==e&&new RegExp("".concat(e,"$")).test(t.textContent.trim()))}var Rt=function(){function t(t,e){var r=this;this.check=function(t){return t?Array.isArray(t)?r.checkEvents(t):r.checkEvent(t):r.checkState()},this.segment=t,this.deps=e}return t.checkForm=function(t,e,r){var n=e[Y.formElement],i=null;switch(r){case Y.formClasses:i="className";break;case Y.formId:i="id";break;case Y.formTarget:i="target";break;case Y.formUrl:i="url"}if(n)if(i)switch(t.operator){case _.equals:return yt(n,i,t.filter);case _.notEquals:return!yt(n,i,t.filter);case _.contains:return wt(n,i,t.filter);case _.notContains:return!wt(n,i,t.filter);case _.startsWith:return Boolean(bt(n,i,t.filter));case _.notStartsWith:return!bt(n,i,t.filter);case _.endsWith:return Boolean(St(n,i,t.filter));case _.notEndsWith:return!St(n,i,t.filter);default:return!1}else switch(r){case Y.formText:switch(t.operator){case _.equals:return Boolean(It(n,t.filter));case _.notEquals:return!It(n,t.filter);case _.contains:return Boolean(Ct(n,t.filter));case _.notContains:return!Ct(n,t.filter);case _.startsWith:return Boolean(Tt(n,t.filter));case _.notStartsWith:return!Tt(n,t.filter);case _.endsWith:return Boolean(Lt(n,t.filter));case _.notEndsWith:return!Lt(n,t.filter);default:return!1}case Y.formElement:switch(t.operator){case _.matchCssSelector:return Et(n,t.filter);case _.notMatchCssSelector:return!Et(n,t.filter);default:return!1}default:return!1}return!1},t.checkElement=function(t,e,r){var n=e[Y.element],i=null;switch(r){case Y.elementClasses:i="className";break;case Y.elementId:i="id";break;case Y.elementTarget:i="target";break;case Y.elementUrl:i="url"}if(n)if(i)switch(t.operator){case _.equals:return Boolean(nt(n,i,t.filter));case _.notEquals:return!nt(n,i,t.filter);case _.contains:return Boolean(it(n,i,t.filter));case _.notContains:return!it(n,i,t.filter);case _.startsWith:return Boolean(ot(n,i,t.filter));case _.notStartsWith:return!ot(n,i,t.filter);case _.endsWith:return Boolean(st(n,i,t.filter));case _.notEndsWith:return!st(n,i,t.filter);case _.matchCssSelector:return Boolean(at(n,t.filter));case _.notMatchCssSelector:return!at(n,t.filter);default:return!1}else switch(r){case Y.elementText:switch(t.operator){case _.equals:return Boolean(It(n,t.filter));case _.notEquals:return!It(n,t.filter);case _.contains:return Boolean(Ct(n,t.filter));case _.notContains:return!Ct(n,t.filter);case _.startsWith:return Boolean(Tt(n,t.filter));case _.notStartsWith:return!Tt(n,t.filter);case _.endsWith:return Boolean(Lt(n,t.filter));case _.notEndsWith:return!Lt(n,t.filter);default:return!1}case Y.element:switch(t.operator){case _.matchCssSelector:return Et(n,t.filter);case _.notMatchCssSelector:return!Et(n,t.filter);default:return!1}default:return!1}return!1},t.checkVisibleElement=function(e,r){var n=r[Y.visibleRatio];switch(e.operator){case _.equals:return t.equals(n,e.filter);case _.notEquals:return t.notEquals(n,e.filter);case _.contains:return ct(n,e.filter);case _.notContains:return ut(n,e.filter);case _.startsWith:return lt(n,e.filter);case _.notStartsWith:return ht(n,e.filter);case _.endsWith:return ft(n,e.filter);case _.notEndsWith:return pt(n,e.filter);case _.greater:case _.greaterOrEquals:case _.less:case _.lessOrEquals:return t.compare(e.filter,n,e.operator);default:return!1}},t.typeFilter=function(t){var e=t.trim();if(String(void 0)!==e)return String(null)===e?null:Number.isNaN(Number(e))?e:Number(e)},t.compare=function(e,r,n){var i=t.typeFilter(e);if(("string"==typeof r||"number"==typeof r)&&"number"==typeof i)switch(n){case _.greaterOrEquals:return r>=i;case _.greater:return r>i;case _.less:return r<i;case _.lessOrEquals:return r<=i;default:return!1}return!1},t.equals=function(e,r){return e===t.typeFilter(r)},t.notEquals=function(e,r){return e!==t.typeFilter(r)},t.checkScrollDirection=function(e,r){var n=r[Y.scrollDirection];switch(e.operator){case _.equals:return t.equals(n,e.filter);case _.notEquals:return t.notEquals(n,e.filter);default:return!1}},t.scrollScrollUnits=function(e,r){var n=r[Y.scrollUnits];switch(e.operator){case _.equals:return t.equals(n,e.filter);case _.notEquals:return t.notEquals(n,e.filter);default:return!1}},t.checkScrollThreshold=function(e,r){var n=r[Y.scrollThreshold];switch(e.operator){case _.equals:return t.equals(n,e.filter);case _.notEquals:return t.notEquals(n,e.filter);case _.contains:return ct(n,e.filter);case _.notContains:return ut(n,e.filter);case _.startsWith:return lt(n,e.filter);case _.notStartsWith:return ht(n,e.filter);case _.endsWith:return ft(n,e.filter);case _.notEndsWith:return pt(n,e.filter);case _.greater:case _.greaterOrEquals:case _.less:case _.lessOrEquals:return t.compare(e.filter,n,e.operator);default:return!1}},t.checkUrl=function(e,r,n){var i=r[n];if(!(i instanceof Element))switch(e.operator){case _.equals:return t.equals(i,e.filter);case _.notEquals:return t.notEquals(i,e.filter);case _.contains:return ct(i,e.filter);case _.notContains:return ut(i,e.filter);case _.startsWith:return lt(i,e.filter);case _.notStartsWith:return ht(i,e.filter);case _.endsWith:return ft(i,e.filter);case _.notEndsWith:return pt(i,e.filter);default:return!1}return!1},t.checkError=function(e,r,n){var i=r[n];if(!(i instanceof Element))switch(e.operator){case _.equals:return t.equals(i,e.filter);case _.notEquals:return t.notEquals(i,e.filter);case _.contains:return ct(i,e.filter);case _.notContains:return ut(i,e.filter);case _.startsWith:return lt(i,e.filter);case _.notStartsWith:return ht(i,e.filter);case _.endsWith:return ft(i,e.filter);case _.notEndsWith:return pt(i,e.filter);default:return!1}return!1},t.prototype.checkVariable=function(e){var r,n=e.argument,i=this.deps.variableStorage.variable(n);if(!i)return!1;switch(r=i.read(),e.operator){case _.equals:return t.equals(r,e.filter);case _.notEquals:return t.notEquals(r,e.filter);case _.contains:return ct(r,e.filter);case _.notContains:return ut(r,e.filter);case _.startsWith:return lt(r,e.filter);case _.notStartsWith:return ht(r,e.filter);case _.endsWith:return ft(r,e.filter);case _.notEndsWith:return pt(r,e.filter);case _.matchCssSelector:return r instanceof Element&&Boolean(at(r,e.filter));case _.notMatchCssSelector:return r instanceof Element&&!at(r,e.filter);case _.greater:case _.greaterOrEquals:case _.less:case _.lessOrEquals:return t.compare(e.filter,r,e.operator);default:return!1}},t.prototype.checkQuery=function(e,r){var n=e.argument,i=function(t){return Boolean(Object.values(Y).find((function(e){return e===t})))}(n);if(i&&function(t){return t.event.startsWith(U)}(r))switch(n){case Y.element:case Y.elementId:case Y.elementClasses:case Y.elementUrl:case Y.elementTarget:case Y.elementText:return t.checkElement(e,r,n);case Y.visibleRatio:return t.checkVisibleElement(e,r);case Y.scrollDirection:return t.checkScrollDirection(e,r);case Y.scrollUnits:return t.scrollScrollUnits(e,r);case Y.scrollThreshold:return t.checkScrollThreshold(e,r);case Y.formElement:case Y.formId:case Y.formClasses:case Y.formUrl:case Y.formTarget:case Y.formText:return t.checkForm(e,r,n);case Y.newUrl:case Y.oldUrl:case Y.newUrlFragment:case Y.oldUrlFragment:return t.checkUrl(e,r,n);case Y.errorUrl:case Y.errorLine:case Y.errorMessage:return t.checkError(e,r,n);default:return!1}return this.checkVariable(e)},t.prototype.checkState=function(){for(var t=!1,e=0;e<this.segment.queries.length;e++)if(!(t=this.checkVariable(this.segment.queries[e])))return t;return t},t.prototype.checkEvent=function(t){for(var e=!1,r=0;r<this.segment.queries.length;r++)if(!(e=this.checkQuery(this.segment.queries[r],t)))return e;return e},t.prototype.checkEvents=function(t){for(var e=!1,r=0;r<t.length;r++)if(e=this.checkEvent(t[r]))return e;return e},t}(),kt=function(){function t(t){this.deps=t}return t.prototype.create=function(t){return new Rt(t,this.deps)},t}(),Dt=function(t){function e(){var e=t.call(this)||this;return e.listeners=null,e}return r(e,t),e.prototype.emit=function(t,e){return o(this,void 0,void 0,(function(){var r,n,i,o;return s(this,(function(s){switch(s.label){case 0:if(!(r=this.listeners))return[3,6];n=Object.keys(r),i=0,s.label=1;case 1:if(!(i<n.length))return[3,6];if(n[i]!==t||!r[t])return[3,5];o=0,s.label=2;case 2:return o<r[t].length?[4,(0,r[t][o])(e)]:[3,5];case 3:s.sent(),s.label=4;case 4:return o++,[3,2];case 5:return i++,[3,1];case 6:return[2]}}))}))},e}(l),xt=function(t){var e=this;this.registerListener=function(t,r){return e.events.registerListener(t,r)},this.deregisterListener=function(t,r){return e.events.deregisterListener(t,r)},this.segmentFactory=new kt({variableStorage:t.deps.variableStorage}),this.strId=t.strId,this.events=new Dt,(null==t?void 0:t.segment)&&(this.segment=this.segmentFactory.create(t.segment))},Pt=function(){this.event=$("triggerGroup")},Ut=function(t){function e(e){var r=t.call(this,e)||this;return r.type=A.GroupTrigger,r.triggerFinished=!1,r.registerEvokedChildren={},r.childListener=r.childListener.bind(r),e.children.forEach((function(t){r.registerEvokedChildren[t.strId]={wasCalled:!1}})),e.children.forEach((function(t){t.registerListener("complete",r.childListener)})),r}return r(e,t),e.prototype.checkAllTriggersHaveBeenCalled=function(){return!Object.values(this.registerEvokedChildren).find((function(t){return!t.wasCalled}))},e.prototype.reset=function(){Object.values(this.registerEvokedChildren).forEach((function(t){t.wasCalled=!1})),this.triggerFinished=!1},e.prototype.childListener=function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(r){return this.registerEvokedChildren[t.trigger.strId].wasCalled||(this.registerEvokedChildren[t.trigger.strId].wasCalled=!0,this.registerEvokedChildren[t.trigger.strId].event=t.event),e=this.checkAllTriggersHaveBeenCalled(),!this.triggerFinished&&e&&this.handler(),[2]}))}))},e.prototype.handler=function(){var t=this,e=[],r=new Pt;if(this.triggerFinished=!0,Object.values(this.registerEvokedChildren).forEach((function(t){t.event&&(Array.isArray(t.event)?e.push.apply(e,c([],a(t.event),!1)):e.push(t.event))})),void 0===this.segment||this.segment.check(e)){var n=c([r],a(e),!1);this.events.emit("run",{trigger:this,event:n,complete:{wasRunning:!0,onRelatedActivitiesCompleted:function(){t.events.emit("complete",{trigger:t,event:c([r],a(e),!1)})}}})}return{wasRunning:!1}},e}(xt),At=function(t){this.event=$("click"),this.elementId=t.elementId,this.elementClasses=t.elementClasses,this.element=t.element,this.elementTarget=t.elementTarget,this.elementUrl=t.elementUrl,this.elementText=t.elementText};Y.elementId,Y.elementClasses,Y.element,Y.elementTarget,Y.elementUrl,Y.elementText;var Ht=function(){this.event=$("init")},_t=function(){this.event=$("viewPage")},qt=function(){this.event=$("domReady")},Ft=function(){this.event=$("windowLoaded")};function Mt(t,e,r){if(void 0===r||0==+r)return Math[t](e);var n=e.toString().split("e");return+((n=Math[t](+(n[0]+"e"+(n[1]?+n[1]-r:-r))).toString().split("e"))[0]+"e"+(n[1]?+n[1]+r:r))}var Nt=function(){function t(e){var r=this,n={root:document.body,rootMargin:"0px",threshold:t.prepareThreshold(e.threshold)},i=e.visibilityTimeRequired||0;this.visibilityTime=0,this.spyIntervalId=null,this.visibilityTimeIntervalId=null,this.observer=new IntersectionObserver((function(n){var o=a(n,1)[0];if(o.isIntersecting){var s=!1;if(0===i){if(!s){s=!0;var c=o.target.getAttribute("target"),u=o.target.getAttribute("href");e.cb({visibleTime:r.visibilityTime,visibleRatio:t.prepareIntersectionRatio(o.intersectionRatio),elementId:o.target.id,elementClasses:o.target.className,element:o.target,elementTarget:c||"",elementUrl:u||""})}}else{var l=r.visibilityTime>=i;if(r.visibilityTimeIntervalId=window.setInterval((function(){if(r.visibilityTime+=100,(l=r.visibilityTime>=i)&&!s){s=!0;var n=o.target.getAttribute("target"),a=o.target.getAttribute("href");e.cb({visibleTime:r.visibilityTime,visibleRatio:t.prepareIntersectionRatio(o.intersectionRatio),elementId:o.target.id,elementClasses:o.target.className,element:o.target,elementTarget:n||"",elementUrl:a||""})}}),100),l&&!s){s=!0;c=o.target.getAttribute("target"),u=o.target.getAttribute("href");e.cb({visibleTime:r.visibilityTime,visibleRatio:t.prepareIntersectionRatio(o.intersectionRatio),elementId:o.target.id,elementClasses:o.target.className,element:o.target,elementTarget:c||"",elementUrl:u||""})}}}else r.clearVisibilityTimeIntervalId()}),n),this.spy(e.selector)}return t.prepareThreshold=function(t){return void 0!==t&&Mt("round",t/100,-2),100},t.prepareIntersectionRatio=function(t){return Mt("round",100*t,0)},t.prototype.spy=function(t){var e=this,r=document.querySelector(t);r?this.observer.observe(r):this.spyIntervalId=window.setInterval((function(){var r=document.querySelector(t);r&&(e.clearSpyIntervalId(),e.observer.observe(r))}),100)},t.prototype.clearSpyIntervalId=function(){this.spyIntervalId&&(clearInterval(this.spyIntervalId),this.spyIntervalId=null)},t.prototype.clearVisibilityTimeIntervalId=function(){this.visibilityTimeIntervalId&&(clearInterval(this.visibilityTimeIntervalId),this.visibilityTimeIntervalId=null)},t.prototype.resetVisibilityTime=function(){this.visibilityTime=0},t.prototype.deactivate=function(){this.clearSpyIntervalId(),this.clearVisibilityTimeIntervalId(),this.resetVisibilityTime(),this.observer.disconnect()},t}(),Ot=function(t){this.event=$("elementVisibility"),this.elementId=t.elementId,this.elementClasses=t.elementClasses,this.element=t.element,this.elementTarget=t.elementTarget,this.elementUrl=t.elementUrl,this.visibleTime=t.visibleTime,this.visibleRatio=t.visibleRatio};Y.elementId,Y.elementClasses,Y.element,Y.elementTarget,Y.elementUrl,Y.visibleRatio,Y.visibleTime;var Wt=function(t){function e(r){var n=t.call(this,r)||this;return n.type=A.DomElementVisible,n.props=r,n.handler=n.handler.bind(n),n.visibilitySensor=new Nt({selector:e.prepareSelector({selector:r.fields.selector,selectorType:r.fields.selectorType}),threshold:r.fields.threshold,visibilityTimeRequired:r.fields.visibilityTimeRequired,cb:n.handler}),n}return r(e,t),e.prepareSelector=function(t){return"id"===t.selectorType?"#".concat(t.selector):t.selector},e.prototype.reset=function(){this.visibilitySensor.deactivate(),this.visibilitySensor=new Nt({selector:e.prepareSelector({selector:this.props.fields.selector,selectorType:this.props.fields.selectorType}),threshold:this.props.fields.threshold,visibilityTimeRequired:this.props.fields.visibilityTimeRequired,cb:this.handler})},e.prototype.handler=function(t){var e=this,r=new Ot({elementId:t.elementId,elementClasses:t.elementClasses,element:t.element,elementTarget:t.elementTarget,elementUrl:t.elementUrl,visibleTime:t.visibleTime,visibleRatio:t.visibleRatio});return void 0===this.segment||this.segment.check(r)?(this.events.emit("run",{trigger:this,event:r}),{wasRunning:!0,onRelatedActivitiesCompleted:function(){e.events.emit("complete",{trigger:e,event:r})}}):{wasRunning:!1}},e}(xt);function Vt(t,e){var r=0;return function(){var n=this,i=arguments;clearTimeout(r),r=window.setTimeout((function(){t.apply(n,i)}),e||100)}}var jt=function(t){this.event=$("scrollDepth"),this.scrollDirection=t.scrollDirection,this.scrollThreshold=t.scrollThreshold,this.scrollUnits=t.scrollUnits};function zt(t){return t.filter((function(t,e,r){return e===r.findIndex((function(e){return e===t}))}))}Y.scrollDirection,Y.scrollThreshold,Y.scrollUnits;var Bt=function(){function t(){}return t.height=function(){return Math.max(document.body.offsetHeight,document.body.clientHeight,document.body.scrollHeight)},t.width=function(){return Math.max(document.body.offsetWidth,document.body.clientWidth,document.body.scrollWidth)},t}(),Gt=function(t){function e(r){var i=t.call(this,r)||this;return i.type=A.ScrollingDepth,i.passedScrollingSteps={vertical:{percents:[],pixels:[]},horizontal:{percents:[],pixels:[]}},i.props=n(n({},r),{fields:e.prepareFields(r.fields)}),i.maxVerticalScrollDepth=0,i.maxHorizontalDepthWidth=0,i.handler=i.handler.bind(i),i.registration=i.registration.bind(i),i.run=i.run.bind(i),i.reset=i.reset.bind(i),i.verticalScrollHandler=i.verticalScrollHandler.bind(i),i.horizontalScrollHandler=i.horizontalScrollHandler.bind(i),i}return r(e,t),e.isScrollingDepthTrigger=function(t){return t.type===A.ScrollingDepth},e.processPercent=function(t){return t.map((function(t){return t<0?0:t>100?100:t}))},e.prepareFields=function(t){var r=n({},t);return r.verticalScrollDepth?G(r.verticalScrollDepth,"percents")?r.verticalScrollDepth.percents=zt(e.processPercent(r.verticalScrollDepth.percents)):G(r.verticalScrollDepth,"pixels")&&(r.verticalScrollDepth.pixels=zt(r.verticalScrollDepth.pixels)):r.horizontalScrollDepth&&(G(r.horizontalScrollDepth,"percents")?r.horizontalScrollDepth.percents=zt(e.processPercent(r.horizontalScrollDepth.percents)):G(r.horizontalScrollDepth,"pixels")&&(r.horizontalScrollDepth.pixels=zt(r.horizontalScrollDepth.pixels))),r},e.prototype.verticalScrollHandler=function(){var t=window.pageYOffset+window.innerHeight;t>this.maxVerticalScrollDepth&&(this.maxVerticalScrollDepth=t,this.run({orientation:"vertical",depth:this.maxVerticalScrollDepth}))},e.prototype.horizontalScrollHandler=function(){var t=window.pageXOffset+window.innerWidth;t>this.maxHorizontalDepthWidth&&(this.maxHorizontalDepthWidth=t,this.run({orientation:"horizontal",depth:this.maxHorizontalDepthWidth}))},e.prototype.registration=function(){this.maxVerticalScrollDepth=0,this.maxHorizontalDepthWidth=0,this.props.fields.verticalScrollDepth&&window.addEventListener("scroll",Vt(this.verticalScrollHandler,500)),this.props.fields.horizontalScrollDepth&&window.addEventListener("scroll",Vt(this.horizontalScrollHandler,500)),this.verticalScrollHandler(),this.horizontalScrollHandler()},e.prototype.checkNeededDepth=function(t){var e=this.props.fields.horizontalScrollDepth,r=this.props.fields.verticalScrollDepth,n=[];switch(t.orientation){case"horizontal":if(e)if(G(e,"percents"))for(var i=0;i<e.percents.length;i++){if(!this.passedScrollingSteps.horizontal.percents.includes(e.percents[i]))t.depth/(Bt.width()||1)*100>=e.percents[i]&&(n.push(new jt({scrollDirection:t.orientation,scrollThreshold:e.percents[i],scrollUnits:"percent"})),this.passedScrollingSteps.horizontal.percents.push(e.percents[i]))}else if(G(e,"pixels"))for(i=0;i<e.pixels.length;i++)this.passedScrollingSteps.horizontal.pixels.includes(e.pixels[i])||t.depth>=e.pixels[i]&&(n.push(new jt({scrollDirection:t.orientation,scrollThreshold:e.pixels[i],scrollUnits:"pixel"})),this.passedScrollingSteps.horizontal.pixels.push(e.pixels[i]));break;case"vertical":if(r)if(G(r,"percents"))for(i=0;i<r.percents.length;i++){if(!this.passedScrollingSteps.vertical.percents.includes(r.percents[i]))t.depth/(Bt.height()||1)*100>=r.percents[i]&&(n.push(new jt({scrollDirection:t.orientation,scrollThreshold:r.percents[i],scrollUnits:"percent"})),this.passedScrollingSteps.vertical.percents.push(r.percents[i]))}else if(G(r,"pixels"))for(i=0;i<r.pixels.length;i++)this.passedScrollingSteps.vertical.pixels.includes(r.pixels[i])||t.depth>=r.pixels[i]&&(n.push(new jt({scrollDirection:t.orientation,scrollThreshold:r.pixels[i],scrollUnits:"pixel"})),this.passedScrollingSteps.vertical.pixels.push(r.pixels[i]))}return n},e.prototype.reset=function(){this.maxVerticalScrollDepth=0,this.maxHorizontalDepthWidth=0,this.passedScrollingSteps.horizontal.pixels=[],this.passedScrollingSteps.horizontal.percents=[],this.passedScrollingSteps.vertical.pixels=[],this.passedScrollingSteps.vertical.percents=[]},e.prototype.update=function(){this.verticalScrollHandler(),this.horizontalScrollHandler()},e.prototype.run=function(t){var e=this;this.checkNeededDepth(t).forEach((function(t){e.handler(t)}))},e.prototype.handler=function(t){var e=this;return void 0===this.segment||this.segment.check(t)?(this.events.emit("run",{trigger:this,event:t}),{wasRunning:!0,onRelatedActivitiesCompleted:function(){e.events.emit("complete",{trigger:e,event:t})}}):{wasRunning:!1}},e}(xt),Jt=function(t){this.event=$("formSubmit"),this.formClasses=t.formClasses,this.formElement=t.formElement,this.formId=t.formId,this.formTarget=t.formTarget,this.formText=t.formText,this.formUrl=t.formUrl};Y.formClasses,Y.formElement,Y.formId,Y.formTarget,Y.formText,Y.formUrl;var Kt=function(t){function e(e){var r,n,i=t.call(this,e)||this;return i.type=A.SubmitForm,i.needActivate=!0,i.waitTags=null===(r=e.fields)||void 0===r?void 0:r.waitTags,(null===(n=e.fields)||void 0===n?void 0:n.activateSegment)&&(i.activateSegment=i.segmentFactory.create(e.fields.activateSegment)),i.activateSegment&&(i.needActivate=i.activateSegment.check()),i}return r(e,t),e.isSubmitFormTrigger=function(t){return t.type===A.SubmitForm},e.prototype.handler=function(t){var e=this;return void 0===this.segment||this.segment.check(t)?(this.events.emit("run",{trigger:this,event:t}),{wasRunning:!0,onRelatedActivitiesCompleted:function(){e.events.emit("complete",{trigger:e,event:t})}}):{wasRunning:!1}},e}(xt);function $t(t){return void 0===t&&(t=0),new Promise((function(e){setTimeout(e,t)}))}function Yt(t,e){var r=function(){var r;return null===(r=e.apply)||void 0===r?void 0:r.call(e,t,this,arguments)};return r.prototype=Object.getPrototypeOf(t),r}var Zt=function(t){this.event=$("historyChange"),this.historyChangeSource=t.historyChangeSource,this.newUrl=t.newUrl,this.oldUrl=t.oldUrl,this.newUrlFragment=t.newUrlFragment,this.oldUrlFragment=t.oldUrlFragment};Y.historyChangeSource,Y.newUrl,Y.oldUrl,Y.newUrlFragment,Y.oldUrlFragment;var Qt=function(t){this.event=$("jsError"),this.errorMessage=t.errorMessage,this.errorUrl=t.errorUrl,this.errorLine=t.errorLine};Y.errorMessage,Y.errorUrl,Y.errorLine;var Xt=function(t){this.event=$("timer"),this.timerCurrentTime=t.timerCurrentTime,this.timerElapsedTime=t.timerElapsedTime,this.timerEventNumber=t.timerEventNumber,this.timerInterval=t.timerInterval,this.timerLimit=t.timerLimit,this.timerStartTime=t.timerStartTime,this.timerEventName=t.timerEventName};Y.timerCurrentTime,Y.timerElapsedTime,Y.timerEventNumber,Y.timerInterval,Y.timerLimit,Y.timerStartTime,Y.timerEventName;var te,ee=function(t){function e(e){var r,n=t.call(this,e)||this;return n.type=A.Timer,n.runCounter=0,n.needActivate=!0,n.props=e,(null===(r=e.fields)||void 0===r?void 0:r.activateSegment)&&(n.activateSegment=n.segmentFactory.create(e.fields.activateSegment)),n.activateSegment&&(n.needActivate=n.activateSegment.check()),n.handler=n.handler.bind(n),n}return r(e,t),e.prototype.countdown=function(){var t=this,e=this.props.fields,r=e.limit,n=e.eventName,i=e.interval,o=Number(new Date);this.intervalID=window.setInterval((function(){if(!r||t.runCounter<=r){var e=Number(new Date);t.runCounter+=1,t.handler(new Xt({timerEventName:n,timerLimit:r,timerInterval:i,timerCurrentTime:e,timerEventNumber:t.runCounter,timerStartTime:o,timerElapsedTime:e-o}))}else window.clearInterval(t.intervalID)}),i)},e.prototype.start=function(){this.intervalID||this.countdown()},e.prototype.reset=function(){window.clearInterval(this.intervalID)},e.prototype.handler=function(t){var e=this;return void 0===this.segment||this.segment.check(t)?(this.events.emit("run",{trigger:this,event:t}),{wasRunning:!0,onRelatedActivitiesCompleted:function(){e.events.emit("complete",{trigger:e,event:t})}}):{wasRunning:!1}},e}(xt),re=function(){function t(e){var r=this;this.groupHandler=function(t){return o(r,void 0,void 0,(function(){var e,r=this;return s(this,(function(n){switch(n.label){case 0:return e=[],[4,this.activateDecorator([t.trigger],(function(){return o(r,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return[4,this.activateInstructions(t.trigger,e,this.createListenerVisitInstruction(e))];case 1:return r.sent(),G(t.complete,"onRelatedActivitiesCompleted")&&t.complete.onRelatedActivitiesCompleted(),[2,{instructions:e,event:Array.isArray(t.event)?t.event[0]:t.event}]}}))}))}))];case 1:return n.sent(),[2]}}))}))},this.timerHandler=function(t){return o(r,void 0,void 0,(function(){var e,r=this;return s(this,(function(n){switch(n.label){case 0:return e=[],[4,this.activateDecorator([t.trigger],(function(){return o(r,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return[4,this.activateInstructions(t.trigger,e,this.createListenerVisitInstruction(e))];case 1:return r.sent(),G(t.complete,"onRelatedActivitiesCompleted")&&t.complete.onRelatedActivitiesCompleted(),[2,{instructions:e,event:Array.isArray(t.event)?t.event[0]:t.event}]}}))}))}))];case 1:return n.sent(),[2]}}))}))},this.clickHandler=function(t){return o(r,void 0,void 0,(function(){var e,r,n,i,a,c,u,l,h=this;return s(this,(function(f){switch(f.label){case 0:return e=this.register.click,r=[],n=[],i=[],a=null,t.target instanceof Element&&(c=t.target.getAttribute("target"),u=t.target.getAttribute("href"),(l=t.target.textContent)&&(l=l.trim()),a=new At({elementId:t.target.id,elementClasses:t.target.className,element:t.target,elementTarget:c||"",elementUrl:u||"",elementText:l})),e&&e.forEach((function(t){var e=t.handler(a);e.wasRunning&&(r.push(t),i.push(e.onRelatedActivitiesCompleted))})),a?[4,this.activateDecorator(r,(function(){return o(h,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.activateInstructions(r,n,this.createListenerVisitInstruction(n))];case 1:return t.sent(),i.forEach((function(t){return t()})),[2,{instructions:n,event:a}]}}))}))}))]:[3,2];case 1:f.sent(),f.label=2;case 2:return[2]}}))}))},this.clickLinkHandler=function(t){return o(r,void 0,void 0,(function(){var e,r,n,i,a,c,u,l,h=this;return s(this,(function(f){switch(f.label){case 0:return e=this.register.click_link,r=[],n=[],i=[],a=null,t.target instanceof Element&&(c=t.target.getAttribute("target"),u=t.target.getAttribute("href"),(l=t.target.textContent)&&(l=l.trim()),a=new At({elementId:t.target.id,elementClasses:t.target.className,element:t.target,elementTarget:c||"",elementUrl:u||"",elementText:l})),e&&e.forEach((function(t){var e=t.handler(a);e.wasRunning&&(r.push(t),i.push(e.onRelatedActivitiesCompleted))})),a?[4,this.activateDecorator(r,(function(){return o(h,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.activateInstructions(r,n,this.createListenerVisitInstruction(n))];case 1:return t.sent(),i.forEach((function(t){return t()})),[2,{instructions:n,event:a}]}}))}))}))]:[3,2];case 1:f.sent(),f.label=2;case 2:return[2]}}))}))},this.customEventHandler=function(t){return o(r,void 0,void 0,(function(){var e,r,n,i,a=this;return s(this,(function(c){switch(c.label){case 0:return e=this.register.custom,r=[],n=[],i=[],e&&e.forEach((function(e){var n=e.handler(t);n.wasRunning&&(r.push(e),i.push(n.onRelatedActivitiesCompleted))})),[4,this.activateDecorator(r,(function(){return o(a,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.activateInstructions(r,n,this.createListenerVisitInstruction(n))];case 1:return e.sent(),i.forEach((function(t){return t()})),[2,{instructions:n,event:t}]}}))}))}))];case 1:return c.sent(),[2]}}))}))},this.initializationHandler=function(t){return o(r,void 0,void 0,(function(){var e,r,n,i,a=this;return s(this,(function(c){switch(c.label){case 0:return e=this.register.initialization,r=[],n=[],i=[],e&&e.forEach((function(e){var n=e.handler(t);n.wasRunning&&(r.push(e),i.push(n.onRelatedActivitiesCompleted))})),[4,this.activateDecorator(r,(function(){return o(a,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.activateInstructions(r,n,this.createListenerVisitInstruction(n))];case 1:return e.sent(),i.forEach((function(t){return t()})),[2,{instructions:n,event:t}]}}))}))}))];case 1:return c.sent(),[2]}}))}))},this.submitFormHandler=function(t){return o(r,void 0,void 0,(function(){var e,r,n,i,a,c,u,l,h,f=this;return s(this,(function(p){switch(p.label){case 0:return t.preventDefault(),e=null===(h=this.register.submit_form)||void 0===h?void 0:h.filter((function(t){return!!Kt.isSubmitFormTrigger(t)&&t.needActivate})),r=[],n=[],i=[],a=null,t.target instanceof Element&&(c=t.target.getAttribute("target"),u=t.target.getAttribute("href"),(l=t.target.textContent)&&(l=l.trim()),a=new Jt({formId:t.target.id,formClasses:t.target.className,formElement:t.target,formTarget:c||"",formUrl:u||"",formText:l})),e&&e.forEach((function(t){var e=t.handler(a);e.wasRunning&&(r.push(t),i.push(e.onRelatedActivitiesCompleted))})),a?[4,this.activateSubmitDecorator(r,(function(){return o(f,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.activateInstructions(r,n,this.createListenerVisitInstruction(n))];case 1:return t.sent(),i.forEach((function(t){return t()})),[2,{instructions:n,event:a}]}}))}))}))]:[3,2];case 1:p.sent(),t.target instanceof HTMLFormElement&&(this.removeForm(t.target),t.target.submit()),p.label=2;case 2:return[2]}}))}))},this.changeHistoryHandler=function(e,n){return o(r,void 0,void 0,(function(){var r,i,a,c,u,l=this;return s(this,(function(h){switch(h.label){case 0:return r=this.register.change_history,i=[],a=[],c=[],u=t.extractHistoryEvent(e,n),r&&r.forEach((function(t){var e=t.handler(u);e.wasRunning&&(i.push(t),c.push(e.onRelatedActivitiesCompleted))})),u?[4,this.activateDecorator(i,(function(){return o(l,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.activateInstructions(i,a,this.createListenerVisitInstruction(a))];case 1:return t.sent(),c.forEach((function(t){return t()})),[2,{instructions:a,event:u}]}}))}))}))]:[3,2];case 1:h.sent(),h.label=2;case 2:return[2]}}))}))},this.jsErrorHandler=function(t){return o(r,void 0,void 0,(function(){var e,r,n,i,a,c=this;return s(this,(function(u){switch(u.label){case 0:return e=this.register.js_error,r=[],n=[],i=[],a=new Qt({errorMessage:t.message,errorLine:t.lineno,errorUrl:t.filename}),e&&e.forEach((function(t){var e=t.handler(a);e.wasRunning&&(r.push(t),i.push(e.onRelatedActivitiesCompleted))})),[4,this.activateDecorator(r,(function(){return o(c,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.activateInstructions(r,n,this.createListenerVisitInstruction(n))];case 1:return t.sent(),i.forEach((function(t){return t()})),[2,{instructions:n,event:a}]}}))}))}))];case 1:return u.sent(),[2]}}))}))},this.register={},this.accumulatorInstruction=[],this.accumulatorForms=[],this.instructionWalker=new z({deps:{instructionStorage:e.instructionStorage}}),this.events=new l,this.privateEvents=new l,this.instructions=e.instructionStorage.content(),this.triggerStorage=e.triggerStorage,this.registerTriggers(e.triggerStorage.categorize())}return t.prototype.createListenerVisitInstruction=function(t){var e=this;return function(r,n){return o(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:switch(r.firingOption){case H.oncePerEvent:return[3,1];case H.noRestrictions:return[3,4];case H.oncePerPage:return[3,6]}return[3,9];case 1:return t.includes(r.strId)?[3,3]:[4,r.run(!n)];case 2:e.sent()&&t.push(r.strId),e.label=3;case 3:return[3,10];case 4:return[4,r.run(!n)];case 5:return e.sent()&&t.push(r.strId),[3,10];case 6:return this.accumulatorInstruction.includes(r.strId)?[3,8]:[4,r.run(!n)];case 7:e.sent()&&this.accumulatorInstruction.push(r.strId),e.label=8;case 8:case 9:return[3,10];case 10:return[2]}}))}))}},t.collectUsingInstructions=function(t,e){var r=[];return e.forEach((function(e){var n;(null===(n=e.triggers)||void 0===n?void 0:n.includes(t))&&r.push(e)})),r},t.collectInstructions=function(e,r){var n=[];return Array.isArray(e)?e.forEach((function(e){n.push.apply(n,c([],a(t.collectUsingInstructions(e.strId,r)),!1))})):n.push.apply(n,c([],a(t.collectUsingInstructions(e.strId,r)),!1)),j.sortInstructionsByPriority(n)},t.prototype.registerTriggers=function(t){var e=this;B(t).forEach((function(r){var n,i,a;switch(e.register[r]=t[r],r){case A.Click:document.addEventListener("click",e.clickHandler);break;case A.ClickLink:document.addEventListener("click",(function(t){t.target instanceof HTMLAnchorElement&&e.clickLinkHandler(t)}));break;case A.GroupTrigger:null===(n=e.register[r])||void 0===n||n.forEach((function(t){t.registerListener("run",(function(t){return o(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.groupHandler(t)];case 1:return e.sent(),[2]}}))}))}))}));break;case A.Custom:e.privateEvents.registerListener("customEvent",e.customEventHandler);break;case A.Initialization:e.privateEvents.registerListener("initialization",(function(){e.initializationHandler(new Ht)}));break;case A.ViewPage:e.privateEvents.registerListener("initialization",(function(){e.viewPageHandler(new _t)}));break;case A.DomReady:"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(function(){e.domReadyHandler(new qt)})):e.domReadyHandler(new qt);break;case A.WindowLoaded:"complete"!==document.readyState?document.addEventListener("load",(function(){e.windowLoadedHandler(new Ft)})):e.windowLoadedHandler(new Ft);break;case A.DomElementVisible:null===(i=e.register[r])||void 0===i||i.forEach((function(t){t.registerListener("run",(function(t){return o(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.domElementVisibilityHandler(t)];case 1:return e.sent(),[2]}}))}))}))}));break;case A.ScrollingDepth:e.registerScrollDepthTriggers();break;case A.SubmitForm:document.addEventListener("click",(function(t){var r=function(t){var e=Boolean(t),r=t instanceof HTMLFormElement,n=t instanceof HTMLInputElement||t instanceof HTMLButtonElement,i=!!n&&("submit"===t.type||"image"===t.type),o=t instanceof HTMLInputElement&&Boolean(t.name||t.value),s=null;if(e)if(n){if((i||o)&&t.form)if(t.form.tagName)s=t.form;else{var a=document.getElementById(t.form.id);a instanceof HTMLFormElement&&(s=a)}}else r&&(s=t);return s}(t.target),n=!1;if(r){for(var i=0;i<e.accumulatorForms.length;i++)if(e.accumulatorForms[i]===r){n=!0;break}n||(e.accumulatorForms.push(r),r.addEventListener("submit",e.submitFormHandler))}}));break;case A.ChangeHistory:window.addEventListener("popstate",(function(t){e.changeHistoryHandler(t,"popstate")})),window.history.pushState=Yt(window.history.pushState,{apply:function(t,r,n){e.changeHistoryHandler({newHistoryState:{data:n[0],unused:n[1],url:n[2]}},"pushState"),t.apply(r,n)}}),window.history.replaceState=Yt(window.history.replaceState,{apply:function(t,r,n){e.changeHistoryHandler({newHistoryState:{data:n[0],unused:n[1],url:n[2]}},"replaceState"),t.apply(r,n)}});break;case A.JSError:window.addEventListener("error",e.jsErrorHandler);break;case A.Timer:null===(a=e.register[r])||void 0===a||a.forEach((function(t){t.registerListener("run",(function(t){return o(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.timerHandler(t)];case 1:return e.sent(),[2]}}))}))})),t instanceof ee&&t.start()}))}}))},t.prototype.registerScrollDepthTriggers=function(){var t,e=this,r=[],n=[],i=[];null===(t=this.register.scrolling_depth)||void 0===t||t.forEach((function(t){if(t.registerListener("run",(function(t){return o(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.scrollDepthHandler(t)];case 1:return e.sent(),[2]}}))}))})),Gt.isScrollingDepthTrigger(t))switch(t.props.fields.waitEvent){case A.ViewPage:r.push(t);break;case A.DomReady:n.push(t);break;case A.WindowLoaded:i.push(t)}})),this.privateEvents.registerListener("initialization",(function(){r.forEach((function(t){return t.registration()}))})),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(function(){n.forEach((function(t){return t.registration()}))})):n.forEach((function(t){return t.registration()})),"complete"!==document.readyState?document.addEventListener("load",(function(){i.forEach((function(t){return t.registration()}))})):i.forEach((function(t){return t.registration()}))},t.prototype.viewPageHandler=function(t){return o(this,void 0,void 0,(function(){var e,r,n,i,a=this;return s(this,(function(c){switch(c.label){case 0:return e=this.register.view_page,r=[],n=[],i=[],e&&e.forEach((function(e){var n=e.handler(t);n.wasRunning&&(r.push(e),i.push(n.onRelatedActivitiesCompleted))})),[4,this.activateDecorator(r,(function(){return o(a,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.activateInstructions(r,n,this.createListenerVisitInstruction(n))];case 1:return e.sent(),i.forEach((function(t){return t()})),[2,{instructions:n,event:t}]}}))}))}))];case 1:return c.sent(),[2]}}))}))},t.prototype.domReadyHandler=function(t){return o(this,void 0,void 0,(function(){var e,r,n,i,a=this;return s(this,(function(c){switch(c.label){case 0:return e=this.register.dom_ready,r=[],n=[],i=[],e&&e.forEach((function(e){var n=e.handler(t);n.wasRunning&&(r.push(e),i.push(n.onRelatedActivitiesCompleted))})),[4,this.activateDecorator(r,(function(){return o(a,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.activateInstructions(r,n,this.createListenerVisitInstruction(n))];case 1:return e.sent(),i.forEach((function(t){return t()})),[2,{instructions:n,event:t}]}}))}))}))];case 1:return c.sent(),[2]}}))}))},t.prototype.windowLoadedHandler=function(t){return o(this,void 0,void 0,(function(){var e,r,n,i,a=this;return s(this,(function(c){switch(c.label){case 0:return e=this.register.window_loaded,r=[],n=[],i=[],e&&e.forEach((function(e){var n=e.handler(t);n.wasRunning&&(r.push(e),i.push(n.onRelatedActivitiesCompleted))})),[4,this.activateDecorator(r,(function(){return o(a,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.activateInstructions(r,n,this.createListenerVisitInstruction(n))];case 1:return e.sent(),i.forEach((function(t){return t()})),[2,{instructions:n,event:t}]}}))}))}))];case 1:return c.sent(),[2]}}))}))},t.prototype.domElementVisibilityHandler=function(t){return o(this,void 0,void 0,(function(){var e,r=this;return s(this,(function(n){switch(n.label){case 0:return e=[],[4,this.activateDecorator([t.trigger],(function(){return o(r,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return[4,this.activateInstructions(t.trigger,e,this.createListenerVisitInstruction(e))];case 1:return r.sent(),G(t.complete,"onRelatedActivitiesCompleted")&&t.complete.onRelatedActivitiesCompleted(),[2,{instructions:e,event:Array.isArray(t.event)?t.event[0]:t.event}]}}))}))}))];case 1:return n.sent(),[2]}}))}))},t.prototype.scrollDepthHandler=function(t){return o(this,void 0,void 0,(function(){var e,r=this;return s(this,(function(n){switch(n.label){case 0:return e=[],[4,this.activateDecorator([t.trigger],(function(){return o(r,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return[4,this.activateInstructions(t.trigger,e,this.createListenerVisitInstruction(e))];case 1:return r.sent(),G(t.complete,"onRelatedActivitiesCompleted")&&t.complete.onRelatedActivitiesCompleted(),[2,{instructions:e,event:Array.isArray(t.event)?t.event[0]:t.event}]}}))}))}))];case 1:return n.sent(),[2]}}))}))},t.extractHistoryEvent=function(t,e){var r=window.location.origin+window.location.pathname,n="",i="",o=window.location.hash;if(W(t,"newHistoryState")&&t.newHistoryState.url)if(t.newHistoryState.url instanceof URL)n=t.newHistoryState.url.origin+t.newHistoryState.url.pathname,i=t.newHistoryState.url.hash;else{var s=new P(t.newHistoryState.url);n="null"===s.origin?window.location.origin+s.pathname:s.origin+s.pathname,i=s.hash}else t instanceof PopStateEvent&&t.target instanceof Window&&(n=t.target.location.origin+t.target.location.pathname,i=t.target.location.href);return"#"===i[0]&&(i=i.slice(1)),"#"===o[0]&&(o=o.slice(1)),new Zt({historyChangeSource:e,newUrl:n,oldUrl:r,newUrlFragment:i,oldUrlFragment:o})},t.prototype.removeForm=function(t){for(;0<this.accumulatorForms.length;0)if(t===this.accumulatorForms[0]){this.accumulatorForms.splice(0,1),t.removeEventListener("submit",this.submitFormHandler);break}},t.prototype.activateSubmitDecorator=function(t,e){return o(this,void 0,void 0,(function(){function r(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){return n.push(t.trigger.strId),[2]}))}))}var n,i,u=this;return s(this,(function(l){return n=[],i=Math.max.apply(Math,c([],a(t.map((function(t){return Kt.isSubmitFormTrigger(t)&&t.waitTags||0}))),!1)),t.forEach((function(t){t.registerListener("complete",r)})),[2,Promise.race([new Promise((function(i){o(u,void 0,void 0,(function(){var o,a,c;return s(this,(function(s){switch(s.label){case 0:return[4,e()];case 1:return o=s.sent(),a=o.instructions,c=o.event,t.forEach((function(t){t.deregisterListener("complete",r)})),c&&this.events.emit("act",{runningTriggers:n,activatedInstructions:a,event:c}),i(),[2]}}))}))})),$t(i)])]}))}))},t.prototype.activateDecorator=function(t,e){return o(this,void 0,void 0,(function(){function r(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){return n.push(t.trigger.strId),[2]}))}))}var n,i,a,c;return s(this,(function(o){switch(o.label){case 0:return n=[],t.forEach((function(t){t.registerListener("complete",r)})),[4,e()];case 1:return i=o.sent(),a=i.instructions,c=i.event,t.forEach((function(t){t.deregisterListener("complete",r)})),c&&this.events.emit("act",{runningTriggers:n,activatedInstructions:a,event:c}),[2]}}))}))},t.prototype.activateInstructions=function(e,r,n){return o(this,void 0,void 0,(function(){var i,o,a;return s(this,(function(s){switch(s.label){case 0:i=t.collectInstructions(e,this.instructions),o=0,s.label=1;case 1:if(!(o<i.length))return[3,11];switch(a=i[o],a.firingOption){case H.oncePerEvent:return[3,2];case H.oncePerPage:return[3,5]}return[3,8];case 2:return r.includes(a.strId)?[3,4]:[4,this.instructionWalker.walk(a,n)];case 3:s.sent(),s.label=4;case 4:return[3,10];case 5:return this.accumulatorInstruction.includes(a.strId)?[3,7]:[4,this.instructionWalker.walk(a,n)];case 6:s.sent(),s.label=7;case 7:return[3,10];case 8:return[4,this.instructionWalker.walk(a,n)];case 9:return s.sent(),[3,10];case 10:return o++,[3,1];case 11:return[2,null]}}))}))},t.prototype.emitEvent=function(t){this.privateEvents.emit("customEvent",t)},t.prototype.initialization=function(){this.privateEvents.emit("initialization")},t.prototype.clean=function(){var t,e,r,n;this.accumulatorInstruction=[],this.accumulatorForms=[],null===(t=this.register[A.GroupTrigger])||void 0===t||t.forEach((function(t){t.type===A.GroupTrigger&&t instanceof Ut&&t.reset()})),null===(e=this.register[A.DomElementVisible])||void 0===e||e.forEach((function(t){t.type===A.DomElementVisible&&t instanceof Wt&&t.reset()})),null===(r=this.register[A.ScrollingDepth])||void 0===r||r.forEach((function(t){t.type===A.ScrollingDepth&&t instanceof Gt&&t.reset()})),null===(n=this.register[A.Timer])||void 0===n||n.forEach((function(t){t.type===A.Timer&&t instanceof ee&&t.reset()}))},t.prototype.update=function(){var t,e;null===(t=this.register[A.ScrollingDepth])||void 0===t||t.forEach((function(t){t.type===A.ScrollingDepth&&t instanceof Gt&&t.update()})),null===(e=this.register[A.Timer])||void 0===e||e.forEach((function(t){t.type===A.Timer&&t instanceof ee&&t.start()}))},t}(),ne=function(){function t(t){this.deps=t}return t.prototype.create=function(t){return new j(t,this.deps)},t}(),ie=function(){function t(t){var e=this;this.instructions={},this.instructionFactory=new ne({tagStorage:t.deps.tagStorage}),t.instructions.forEach((function(t){e.instructions[t.strId]=e.instructionFactory.create(t)}))}return t.prototype.instruction=function(t){return this.instructions[t]},t.prototype.content=function(){var t=this;return B(this.instructions).map((function(e){return t.instructions[e]}))},t}(),oe=function(t){function e(e){var r=t.call(this,e)||this;return r.type=A.Click,r.handler=r.handler.bind(r),r}return r(e,t),e.prototype.handler=function(t){var e=this;return void 0===this.segment||this.segment.check(t)?(this.events.emit("run",{trigger:this,event:t}),{wasRunning:!0,onRelatedActivitiesCompleted:function(){e.events.emit("complete",{trigger:e,event:t})}}):{wasRunning:!1}},e}(xt),se=function(){function t(t){this.type=A.Click,this.deps=t}return t.prototype.create=function(t){return new oe({strId:t.strId,segment:t.segment,deps:{variableStorage:this.deps.variableStorage,dataLayer:this.deps.dataLayer}})},t}(),ae=function(){function t(t){this.type=A.GroupTrigger,this.deps=t}return t.prototype.create=function(t){var e,r=this,n=[];return null===(e=t.children)||void 0===e||e.forEach((function(t){var e=r.deps.triggersStorage.trigger(t);e&&n.push(e)})),new Ut({strId:t.strId,segment:t.segment,deps:{variableStorage:this.deps.variableStorage,dataLayer:this.deps.dataLayer},children:n})},t}(),ce=function(t){function e(e){var r=t.call(this,e)||this;return r.type=A.Custom,r.handler=r.handler.bind(r),r}return r(e,t),e.prototype.handler=function(t){var e=this;return void 0===this.segment||this.segment.check(t)?(this.events.emit("run",{trigger:this,event:t}),{wasRunning:!0,onRelatedActivitiesCompleted:function(){e.events.emit("complete",{trigger:e,event:t})}}):{wasRunning:!1}},e}(xt),ue=function(){function t(t){this.type=A.Custom,this.deps=t}return t.prototype.create=function(t){return new ce({strId:t.strId,segment:t.segment,deps:{variableStorage:this.deps.variableStorage,dataLayer:this.deps.dataLayer}})},t}(),le=function(t){function e(e){var r=t.call(this,e)||this;return r.type=A.Initialization,r.handler=r.handler.bind(r),r}return r(e,t),e.prototype.handler=function(t){var e=this;return void 0===this.segment||this.segment.check(t)?(this.events.emit("run",{trigger:this,event:t}),{wasRunning:!0,onRelatedActivitiesCompleted:function(){e.events.emit("complete",{trigger:e,event:t})}}):{wasRunning:!1}},e}(xt),he=function(){function t(t){this.type=A.Initialization,this.deps=t}return t.prototype.create=function(t){return new le({strId:t.strId,segment:t.segment,deps:{variableStorage:this.deps.variableStorage,dataLayer:this.deps.dataLayer}})},t}(),fe=function(t){function e(e){var r=t.call(this,e)||this;return r.type=A.ViewPage,r.handler=r.handler.bind(r),r}return r(e,t),e.prototype.handler=function(t){var e=this;return void 0===this.segment||this.segment.check(t)?(this.events.emit("run",{trigger:this,event:t}),{wasRunning:!0,onRelatedActivitiesCompleted:function(){e.events.emit("complete",{trigger:e,event:t})}}):{wasRunning:!1}},e}(xt),pe=function(){function t(t){this.type=A.ViewPage,this.deps=t}return t.prototype.create=function(t){return new fe({strId:t.strId,segment:t.segment,deps:{variableStorage:this.deps.variableStorage,dataLayer:this.deps.dataLayer}})},t}(),de=function(t){function e(e){var r=t.call(this,e)||this;return r.type=A.DomReady,r.handler=r.handler.bind(r),r}return r(e,t),e.prototype.handler=function(t){var e=this;return void 0===this.segment||this.segment.check(t)?(this.events.emit("run",{trigger:this,event:t}),{wasRunning:!0,onRelatedActivitiesCompleted:function(){e.events.emit("complete",{trigger:e,event:t})}}):{wasRunning:!1}},e}(xt),me=function(){function t(t){this.type=A.DomReady,this.deps=t}return t.prototype.create=function(t){return new de({strId:t.strId,segment:t.segment,deps:{variableStorage:this.deps.variableStorage,dataLayer:this.deps.dataLayer}})},t}(),ve=function(t){function e(e){var r=t.call(this,e)||this;return r.type=A.WindowLoaded,r.handler=r.handler.bind(r),r}return r(e,t),e.prototype.handler=function(t){var e=this;return void 0===this.segment||this.segment.check(t)?(this.events.emit("run",{trigger:this,event:t}),{wasRunning:!0,onRelatedActivitiesCompleted:function(){e.events.emit("complete",{trigger:e,event:t})}}):{wasRunning:!1}},e}(xt),ge=function(){function t(t){this.type=A.WindowLoaded,this.deps=t}return t.prototype.create=function(t){return new ve({strId:t.strId,segment:t.segment,deps:{variableStorage:this.deps.variableStorage,dataLayer:this.deps.dataLayer}})},t}(),ye=function(t){function e(e){var r=t.call(this,e)||this;return r.type=A.ClickLink,r.handler=r.handler.bind(r),r}return r(e,t),e.prototype.handler=function(t){var e=this;return void 0===this.segment||this.segment.check(t)?(this.events.emit("run",{trigger:this,event:t}),{wasRunning:!0,onRelatedActivitiesCompleted:function(){e.events.emit("complete",{trigger:e,event:t})}}):{wasRunning:!1}},e}(xt),we=function(){function t(t){this.type=A.ClickLink,this.deps=t}return t.prototype.create=function(t){return new ye({strId:t.strId,segment:t.segment,deps:{variableStorage:this.deps.variableStorage,dataLayer:this.deps.dataLayer}})},t}(),be=function(){function t(t){this.type=A.DomElementVisible,this.deps=t}return t.prototype.create=function(t){return new Wt({strId:t.strId,segment:t.segment,fields:t.fields,deps:{variableStorage:this.deps.variableStorage,dataLayer:this.deps.dataLayer}})},t}(),Se=function(){function t(t){this.type=A.ScrollingDepth,this.deps=t}return t.prototype.create=function(t){return new Gt({strId:t.strId,segment:t.segment,fields:t.fields,deps:{variableStorage:this.deps.variableStorage,dataLayer:this.deps.dataLayer}})},t}(),Ee=function(){function t(t){this.type=A.SubmitForm,this.deps=t}return t.prototype.create=function(t){return new Kt({strId:t.strId,segment:t.segment,fields:t.fields,deps:{variableStorage:this.deps.variableStorage,dataLayer:this.deps.dataLayer}})},t}(),Ie=function(t){function e(e){var r=t.call(this,e)||this;return r.type=A.ChangeHistory,r.handler=r.handler.bind(r),r}return r(e,t),e.prototype.handler=function(t){var e=this;return void 0===this.segment||this.segment.check(t)?(this.events.emit("run",{trigger:this,event:t}),{wasRunning:!0,onRelatedActivitiesCompleted:function(){e.events.emit("complete",{trigger:e,event:t})}}):{wasRunning:!1}},e}(xt),Ce=function(){function t(t){this.type=A.ChangeHistory,this.deps=t}return t.prototype.create=function(t){return new Ie({strId:t.strId,segment:t.segment,deps:{variableStorage:this.deps.variableStorage,dataLayer:this.deps.dataLayer}})},t}(),Te=function(t){function e(e){var r=t.call(this,e)||this;return r.type=A.JSError,r.handler=r.handler.bind(r),r}return r(e,t),e.prototype.handler=function(t){var e=this;return void 0===this.segment||this.segment.check(t)?(this.events.emit("run",{trigger:this,event:t}),{wasRunning:!0,onRelatedActivitiesCompleted:function(){e.events.emit("complete",{trigger:e,event:t})}}):{wasRunning:!1}},e}(xt),Le=function(){function t(t){this.type=A.JSError,this.deps=t}return t.prototype.create=function(t){return new Te({strId:t.strId,segment:t.segment,deps:{variableStorage:this.deps.variableStorage,dataLayer:this.deps.dataLayer}})},t}(),Re=function(){function t(t){this.type=A.Timer,this.deps=t}return t.prototype.create=function(t){return new ee({strId:t.strId,segment:t.segment,fields:t.fields,deps:{variableStorage:this.deps.variableStorage,dataLayer:this.deps.dataLayer}})},t}(),ke=function(){function t(t){var e=this,r=this.sortTriggers(t.triggers),n=t.deps,o=n.variableStorage,s=n.dataLayer;this.triggers={},this.factories={},this.registerFactory(new se({dataLayer:s,variableStorage:o}),new ae({dataLayer:s,variableStorage:o,triggersStorage:this}),new ue({dataLayer:s,variableStorage:o}),new he({dataLayer:s,variableStorage:o}),new pe({dataLayer:s,variableStorage:o}),new me({dataLayer:s,variableStorage:o}),new ge({dataLayer:s,variableStorage:o}),new we({dataLayer:s,variableStorage:o}),new be({dataLayer:s,variableStorage:o}),new Se({dataLayer:s,variableStorage:o}),new Ee({dataLayer:s,variableStorage:o}),new Ce({dataLayer:s,variableStorage:o}),new Le({dataLayer:s,variableStorage:o}),new Re({dataLayer:s,variableStorage:o})),r.forEach((function(t){var r=t.type,n=i(t,["type"]);e.triggers[t.strId]=e.factories[r].create(n)}))}return t.prototype.registerFactory=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];e.forEach((function(e){t.factories[e.type]=e}))},t.prototype.sortTriggers=function(t){var e=c([],a(t),!1);return e.sort((function(t,e){return t.type===A.GroupTrigger?e.children&&e.children.includes(t.strId)?-1:1:-1})),e},t.prototype.trigger=function(t){return this.triggers[t]},t.prototype.categorize=function(){var t=this,e=Object.keys(this.triggers),r={};return e.forEach((function(e){var n=t.triggers[e],i=n.type;if(r[i]){var o=r[i];o&&o.push(n)}else r[i]=[n]})),r},t}();!function(t){t.Html="html",t.Popup="popup",t.Form="form",t.Push="push",t.TEST_ASYNC="test_async"}(te||(te={}));var De,xe=function(t){this.strId=t.strId,this.environment=t.environment};function Pe(t,e,r){var n=document.createRange().createContextualFragment(e);switch(r){case De.Before:t.before(n);break;case De.After:t.after(n);break;case De.LastChild:t.appendChild(n);break;case De.FirstChild:t.prepend(n);break;default:t.appendChild(n)}}!function(t){t.Before="before",t.After="after",t.FirstChild="first_child",t.LastChild="last_child"}(De||(De={}));var Ue=function(t){function e(e){var r=t.call(this,e)||this;return r.type=te.Html,r.html=e.fields.html,r}return r(e,t),e.prototype.run=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){return Pe(document.body,this.html),[2]}))}))},e}(xe),Ae=function(){function t(t){this.type=te.Html,this.environment=t}return t.prototype.create=function(t){return new Ue(n(n({},t),{environment:this.environment}))},t}(),He=function(t){function e(e){var r=t.call(this,e)||this;return r.type=te.TEST_ASYNC,r.wait=e.fields.wait,r}return r(e,t),e.prototype.run=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,$t(this.wait)];case 1:return t.sent(),[2]}}))}))},e}(xe),_e=function(){function t(t){this.type=te.TEST_ASYNC,this.environment=t}return t.prototype.create=function(t){return new He(n(n({},t),{environment:this.environment}))},t}(),qe="Altcraft Error Response",Fe=function(t){function e(e){var r=this,n=e.error;return(r=t.call(this,qe)||this).name=qe,r.error=n,r.error_text=e.error_text,r}return r(e,t),e}(Error),Me="AC Network Error",Ne=function(t){function e(e){var r=t.call(this,Me)||this;return r.name=Me,r.error=e.error,r}return r(e,t),e}(Error);function Oe(t){return o(this,void 0,void 0,(function(){var e,r,n,i,o,a,c,u,l;return s(this,(function(s){switch(s.label){case 0:e=t.url,r=void 0===e?"":e,n=t.type,i=void 0===n?"POST":n,o=t.data,a=void 0===o?{}:o,c={mode:"cors",method:i,body:"POST"===i?JSON.stringify(a):void 0},s.label=1;case 1:return s.trys.push([1,4,,5]),[4,fetch(r,c)];case 2:return[4,s.sent().json()];case 3:return G(u=s.sent(),"error")&&u.error>0?[2,Promise.reject(new Fe(u))]:[2,Promise.resolve(u)];case 4:return l=s.sent(),[2,Promise.reject(new Ne({error:l}))];case 5:return[2]}}))}))}var We=function(t){this.message=t,this.name="AkApiLibError"};function Ve(t,e){var r=t,n=e;if(r>n)throw new We("Execution error generateRandom: min > max.");return r=Math.ceil(r),n=Math.floor(n),Math.floor(Math.random()*(n-r)+r)}var je,ze=function(t){function e(e){var r=t.call(this,e)||this;r.type=te.Popup;var n=e.fields.id;return r.dotJSImport=e.dotJSImport,r.dataRequest=Oe({url:"".concat(r.environment.domain,"/popup"),data:{id:n}}),r}return r(e,t),e.renderCss=function(t){return"<style>".concat(t,"</style>")},e.renderJs=function(t){return"<script>\n                (function() {\n                    ".concat(t,"\n                })();\n            <\/script>")},e.renderHtml=function(t,r,n){return'<div id="'.concat(t,'" class="').concat(e.AC_WIDGET_ID,'">\n                ').concat(n,"\n                ").concat(r,"\n            </div>")},e.prototype.run=function(){return o(this,void 0,void 0,(function(){var t,r,n,i,o,c,u,l;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,Promise.all([this.dotJSImport,this.dataRequest])];case 1:return t=a.apply(void 0,[s.sent(),2]),r=t[0],(n=t[1]).data&&(i=null==r?void 0:r.default.template(n.data.templates.html),o=null==r?void 0:r.default.template(n.data.templates.css),c=null==r?void 0:r.default.template(n.data.templates.js),u="".concat(e.AC_WIDGET_ID,"-").concat(Ve(1,1e4)),i&&(Pe(document.body,e.renderHtml(u,String(i(n.data.data)),e.renderCss(String(o(n.data.data))))),setTimeout((function(){var t=document.getElementById(u);t&&n.data&&Pe(t,e.renderJs(String(c(n.data.data))))})))),[3,3];case 2:return l=s.sent(),console.error(l),[3,3];case 3:return[2]}}))}))},e.AC_WIDGET_ID="altcraft-popup-widget",e}(xe),Be=function(){function t(t,e){this.type=te.Popup,this.environment=t,this.loader=e}return t.prototype.create=function(t){return new ze(n(n({},t),{environment:this.environment,dotJSImport:this.loader.dotJSImport}))},t}();!function(t){t.Before="before",t.After="after",t.FirstChild="first_child",t.LastChild="last_child"}(je||(je={}));var Ge=function(t){function e(e){var r=t.call(this,e)||this;r.type=te.Form;var n=e.fields.id;return r.dataRequest=Oe({url:"".concat(r.environment.domain,"/get_form"),data:{id:n}}),r}return r(e,t),e.renderEmbedScript=function(t){return'<script id="'.concat(e.EMBED_FORM_SCRIPT_ID,'" src="').concat(t,'"><\/script>')},e.renderIframe=function(t,e){return'<iframe src="'.concat(t,'" frameborder="0" name="ak-form-').concat(e,'" class="ak-form" width="100%" sandbox="allow-same-origin allow-forms allow-scripts allow-popups allow-popups-to-escape-sandbox"></iframe>')},e.prototype.run=function(){return o(this,void 0,void 0,(function(){var t,r,n,i,o,c;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,Promise.all([this.dataRequest])];case 1:return t=a.apply(void 0,[s.sent(),1]),(r=t[0]).data&&(n=r.data.link.split("=")[1],i=document.querySelector(r.data.anchor_point.selector),o=Boolean(document.getElementById(e.EMBED_FORM_SCRIPT_ID)),i&&Pe(i,o?e.renderIframe(r.data.link,n):"".concat(e.renderEmbedScript(r.data.embed_src),"\n                               ").concat(e.renderIframe(r.data.link,n),"\n                               "),r.data.anchor_point.placement)),[3,3];case 2:return c=s.sent(),console.error(c),[3,3];case 3:return[2]}}))}))},e.EMBED_FORM_SCRIPT_ID="altcraft-form-embed",e}(xe),Je=function(){function t(t){this.type=te.Form,this.environment=t}return t.prototype.create=function(t){return new Ge(n(n({},t),{environment:this.environment}))},t}(),Ke=function(t){function e(e){var r=t.call(this,e)||this;return r.type=te.Push,r.swPath=e.fields.swPath,r.resourceToken=e.fields.resourceToken,r.AKPushImport=e.AKPushImport,r.dataRequest=new Promise((function(t){t({data:{browsers:{Chrome:{isFirebase:!0},Firefox:{isFirebase:!1},Opera:{isFirebase:!1},"Yandex Browser":{isFirebase:!1},"Samsung Internet for Android":{isFirebase:!1},Safari:{websitePushID:"",websitePushAPI:"",cookieId:""}},firebase:{apiKey:"AIzaSyAkRFMa_SfLoL_WKnyBIwoBLhE09WHGzVU",projectId:"maksim-push",messagingSenderId:"366281823968"},serverSavePath:"/pixel?_push_pix=/push/subscription/save",serverDeletePath:"/pixel?_push_pix=/push/subscription/delete",serverCookiePath:"/pixel?_push_pix=/set_cookie_only",serverPushContentPath:"/pixel?_push_pix=/push/content/get",serverURL:"https://pxl.maksim-lavrenyuk.dev.altkraft.com"},error:0})})),r}return r(e,t),e.prototype.run=function(){return o(this,void 0,void 0,(function(){var t,e,r,i;return s(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),[4,Promise.all([this.AKPushImport,this.dataRequest])];case 1:return t=a.apply(void 0,[o.sent(),2]),e=t[0],(r=t[1]).data?(this.swPath&&(r.data=n(n({},r.data),{swPath:this.swPath})),[4,new e(n(n({},r.data),{resourceToken:this.resourceToken})).initSubscription()]):[3,3];case 2:o.sent(),o.label=3;case 3:return[3,5];case 4:return i=o.sent(),console.error(i),[3,5];case 5:return[2]}}))}))},e}(xe),$e=function(){function t(t,e){this.type=te.Push,this.environment=t,this.loader=e}return t.prototype.create=function(t){return new Ke(n(n({},t),{environment:this.environment,AKPushImport:this.loader.AKPushImport}))},t}(),Ye=function(e){var r=this;e.tagsTypes.forEach((function(n){switch(n){case te.Popup:r.dotJSImport=(i="".concat(e.environment.domain,"/template.js"),Promise.resolve().then((function(){return t(require(i))})));break;case te.Push:r.AKPushImport=function(e){return Promise.resolve().then((function(){return t(require(e))}))}("".concat(e.environment.domain,"/AKPush.js"))}var i}))},Ze=function(){function t(t,e){var r=this;this.tags={},this.factories={};var n=zt(t.map((function(t){return t.type}))),o=new Ye({environment:e,tagsTypes:n});this.registerFactory(new Ae(e),new _e(e),new Be(e,o),new Je(e),new $e(e,o)),t.forEach((function(t){var e=t.type,n=i(t,["type"]);r.tags[t.strId]=r.factories[e].create(n)}))}return t.prototype.registerFactory=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];e.forEach((function(e){t.factories[e.type]=e}))},t.prototype.tag=function(t){return this.tags[t]},t}(),Qe=function(t){this.strId=t.strId,this.environment=t.environment},Xe=function(t){function e(e){var r=t.call(this,e)||this;return r.type=Z.DomElement,r.selectorType=e.fields.selectorType,r.selector=e.fields.selector,r.attrName=e.fields.attrName,r}return r(e,t),e.prototype.read=function(){var t,e=null;return(t="id"===this.selectorType?document.getElementById(this.selector):document.querySelector(this.selector))&&(e=t.getAttribute(this.attrName)),e},e}(Qe),tr=function(t){this.environment=t},er=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=Z.DomElement,e}return r(e,t),e.prototype.create=function(t){return new Xe(n(n({},t),{environment:this.environment}))},e}(tr);var rr,nr={generateRandom:Ve,fromBase64:function(t){try{return function(t){return decodeURIComponent(Array.prototype.map.call(atob(t),(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join(""))}(t)}catch(t){return}},toBase64:function(t){try{return function(t){return btoa(encodeURIComponent(t).replace(/%([\dA-F]{2})/g,(function(t,e){return String.fromCharCode(Number("0x"+e))})))}(t)}catch(t){return}},templateStorage:new(function(){function t(){this.storage={}}return t.prototype.getItem=function(t){return this.storage[t]},t.prototype.setItem=function(t,e){this.storage[t]=e},t.prototype.removeItem=function(t){delete this.storage[t]},t.prototype.clear=function(){this.storage={}},t}())};!function(t){t.tag="tag",t.variable="variable"}(rr||(rr={}));var ir=function(){function t(){}return t.convertBody=function(t){return t.replace(/require/g,"akRequire")},t.akRequire=function(t){return nr[t]},t.build=function(e){return new Function("data",t.convertBody(e))},t}();window.akRequire=ir.akRequire;var or,sr=function(t){function e(r){var n=t.call(this,{strId:r.strId,environment:r.environment})||this;return n.type=e.TYPE,n.body=r.body||"",n.fields=r.fields,n.variable=ir.build(n.body),n}return r(e,t),e.prototype.read=function(){return this.variable(this.fields||{})},e.TYPE="templateVariable",e}(Qe),ar=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=sr.TYPE,e}return r(e,t),e.prototype.create=function(t){return new sr(n({environment:this.environment},t))},e}(tr),cr=function(t){function e(e){var r=t.call(this,e)||this;return r.type=Z.CustomVariable,r.read=function(){return r.value},r.value=e.value,r}return r(e,t),e}(Qe),ur=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=Z.CustomVariable,e}return r(e,t),e.prototype.create=function(t){return new cr(t)},e}(tr);!function(t){t.PagePath="PagePath",t.PageHostName="PageHostName",t.PageURL="PageURL",t.Referrer="Referrer",t.DebugMode="DebugMode",t.ContainerID="ContainerID"}(or||(or={}));var lr=function(t){function e(e){var r=t.call(this,n(n({},e),{strId:$(or.Referrer)}))||this;return r.type=or.Referrer,r}return r(e,t),e.prototype.read=function(){return document.referrer},e}(Qe),hr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=or.Referrer,e}return r(e,t),e.prototype.create=function(){return new lr({environment:this.environment})},e}(tr);var fr,pr=function(t){function e(e){var r=t.call(this,n(n({},e),{strId:$(or.PageURL)}))||this;return r.type=or.PageURL,r}return r(e,t),e.prototype.read=function(){return window.location.href},e}(Qe),dr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=or.PageURL,e}return r(e,t),e.prototype.create=function(){return new pr({environment:this.environment})},e}(tr),mr=function(t){function e(e){var r=t.call(this,n(n({},e),{strId:$(or.PagePath)}))||this;return r.type=or.PagePath,r}return r(e,t),e.prototype.read=function(){return window.location.pathname},e}(Qe),vr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=or.PagePath,e}return r(e,t),e.prototype.create=function(){return new mr({environment:this.environment})},e}(tr),gr=function(t){function e(e){var r=t.call(this,n(n({},e),{strId:$(or.PageHostName)}))||this;return r.type=or.PageHostName,r}return r(e,t),e.prototype.read=function(){return window.location.hostname},e}(Qe),yr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=or.PageHostName,e}return r(e,t),e.prototype.create=function(){return new gr({environment:this.environment})},e}(tr),wr=function(t){function e(e){var r=t.call(this,n(n({},e),{strId:$(or.DebugMode)}))||this;return r.type=or.DebugMode,r}return r(e,t),e.prototype.read=function(){return this.environment.isDebug},e}(Qe),br=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=or.DebugMode,e}return r(e,t),e.prototype.create=function(){return new wr({environment:this.environment})},e}(tr),Sr=function(t){function e(e){var r=t.call(this,n(n({},e),{strId:$(or.ContainerID)}))||this;return r.type=or.ContainerID,r}return r(e,t),e.prototype.read=function(){return this.environment.containerID},e}(Qe),Er=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=or.ContainerID,e}return r(e,t),e.prototype.create=function(){return new Sr({environment:this.environment})},e}(tr);!function(t){t.Full="Full",t.Protocol="Protocol",t.HostName="HostName",t.Port="Port",t.Path="Path",t.FileExtension="FileExtension",t.Request="Request",t.Fragment="Fragment"}(fr||(fr={}));var Ir=/^www\./;var Cr,Tr=function(t){function e(e){var r=t.call(this,e)||this;return r.type=Z.URL,r.fields=e.fields,r}return r(e,t),e.prototype.read=function(){if(this.fields.type===fr.HostName)return t=this.fields.cleanUp,e=window.location.hostname,t?e.replace(Ir,""):e;var t,e,r,n;if(function(t){return t.type===fr.Request}(this.fields))return function(t){for(var e=new P(window.location.href,!0),r=Object.keys(e.query),n=0;n<r.length;n++)if(r[n]===t&&t.length>0)return e.query[r[n]]}(this.fields.key);if(function(t){return t.type===fr.Path}(this.fields))return function(t){for(var e=0;e<t.length;e++){var r=t[e],n=new RegExp("/".concat(r,"$"));if(n.test(window.location.pathname))return window.location.pathname.replace(n,"")}return window.location.pathname}(this.fields.pages);switch(this.fields.type){case fr.Full:return window.location.href;case fr.Protocol:return window.location.protocol.replace(/:$/,"");case fr.Port:return window.location.port;case fr.Fragment:return window.location.hash.replace(/^#/,"");case fr.FileExtension:return r=window.location.pathname,(n=r.split(".").pop())===r?"":n;default:return}},e}(Qe),Lr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=Z.URL,e}return r(e,t),e.prototype.create=function(t){return new Tr(n(n({},t),{environment:this.environment}))},e}(tr);!function(t){t.Full="Full",t.Protocol="Protocol",t.HostName="HostName",t.Port="Port",t.Path="Path",t.FileExtension="FileExtension",t.Request="Request",t.Fragment="Fragment"}(Cr||(Cr={}));var Rr=/^www\./;var kr=function(t){function e(e){var r=t.call(this,e)||this;return r.type=Z.URLReferrer,r.fields=e.fields,r}return r(e,t),e.prototype.read=function(){if(this.fields.type===Cr.HostName)return t=this.fields.cleanUp,e=new P(document.referrer),t?e.hostname.replace(Rr,""):e.hostname;var t,e;if(function(t){return t.type===Cr.Request}(this.fields))return function(t){for(var e=new P(document.referrer,!0),r=Object.keys(e.query),n=0;n<r.length;n++)if(r[n]===t&&t.length>0)return e.query[r[n]]}(this.fields.key);if(function(t){return t.type===Cr.Path}(this.fields))return function(t){for(var e=new P(document.referrer),r=0;r<t.length;r++){var n=t[r],i=new RegExp("/".concat(n,"$"));if(i.test(e.pathname))return e.pathname.replace(i,"")}return e.pathname}(this.fields.pages);switch(this.fields.type){case Cr.Full:return document.referrer;case Cr.Protocol:return new P(document.referrer).protocol.replace(/:$/,"");case Cr.Port:return new P(document.referrer).port;case Cr.Fragment:return new P(document.referrer).hash.replace(/^#/,"");case Cr.FileExtension:return function(){var t=new P(document.referrer),e=t.pathname.split(".").pop();return e===t.pathname?"":e}();default:return}},e}(Qe),Dr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=Z.URLReferrer,e}return r(e,t),e.prototype.create=function(t){return new kr(n(n({},t),{environment:this.environment}))},e}(tr),xr=function(t){function e(e){var r=t.call(this,e)||this;return r.type=Z.JSVariable,r.fields=e.fields,r}return r(e,t),e.prototype.read=function(){return window[this.fields.variableName]},e}(Qe),Pr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=Z.JSVariable,e}return r(e,t),e.prototype.create=function(t){return new xr(n(n({},t),{environment:this.environment}))},e}(tr),Ur=function(t){function e(e){var r=t.call(this,e)||this;r.type=Z.JSCode;try{r.func=new Function("params","return (".concat(e.fields.code,")()"))}catch(t){r.func=void 0}return r}return r(e,t),e.prototype.read=function(){if("function"==typeof this.func)return this.func()},e}(Qe),Ar=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=Z.JSCode,e}return r(e,t),e.prototype.create=function(t){return new Ur(n(n({},t),{environment:this.environment}))},e}(tr),Hr=function(t,e){if("string"!=typeof t)throw new TypeError("argument str must be a string");var r={},n=(e||{}).decode||Mr,i=0;for(;i<t.length;){var o=t.indexOf("=",i);if(-1===o)break;var s=t.indexOf(";",i);if(-1===s)s=t.length;else if(s<o){i=t.lastIndexOf(";",o-1)+1;continue}var a=t.slice(i,o).trim();if(void 0===r[a]){var c=t.slice(o+1,s).trim();34===c.charCodeAt(0)&&(c=c.slice(1,-1)),r[a]=Or(c,n)}i=s+1}return r},_r=function(t,e,r){var n=r||{},i=n.encode||Nr;if("function"!=typeof i)throw new TypeError("option encode is invalid");if(!Fr.test(t))throw new TypeError("argument name is invalid");var o=i(e);if(o&&!Fr.test(o))throw new TypeError("argument val is invalid");var s=t+"="+o;if(null!=n.maxAge){var a=n.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");s+="; Max-Age="+Math.floor(a)}if(n.domain){if(!Fr.test(n.domain))throw new TypeError("option domain is invalid");s+="; Domain="+n.domain}if(n.path){if(!Fr.test(n.path))throw new TypeError("option path is invalid");s+="; Path="+n.path}if(n.expires){var c=n.expires;if(!function(t){return"[object Date]"===qr.call(t)||t instanceof Date}(c)||isNaN(c.valueOf()))throw new TypeError("option expires is invalid");s+="; Expires="+c.toUTCString()}n.httpOnly&&(s+="; HttpOnly");n.secure&&(s+="; Secure");if(n.priority){switch("string"==typeof n.priority?n.priority.toLowerCase():n.priority){case"low":s+="; Priority=Low";break;case"medium":s+="; Priority=Medium";break;case"high":s+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(n.sameSite){switch("string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;case"none":s+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return s},qr=Object.prototype.toString,Fr=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function Mr(t){return-1!==t.indexOf("%")?decodeURIComponent(t):t}function Nr(t){return encodeURIComponent(t)}function Or(t,e){try{return e(t)}catch(e){return t}}var Wr={parse:Hr,serialize:_r},Vr=function(t){function e(e){var r=t.call(this,e)||this;return r.type=Z.Cookie,r.cookieName=e.fields.name,r.decodeURI=e.fields.decodeURI,r}return r(e,t),e.prototype.read=function(){return Wr.parse(document.cookie,{decode:this.decodeURI?void 0:function(t){return t}})[this.cookieName]},e}(Qe),jr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=Z.Cookie,e}return r(e,t),e.prototype.create=function(t){return new Vr(n(n({},t),{environment:this.environment}))},e}(tr);var zr=function(t){function e(e){var r=t.call(this,e)||this;return r.type=Z.ElementVisible,r.selectorType=e.fields.selectorType,r.selector=e.fields.selector,r.resultType=e.fields.resultType,r.threshold="boolean"===e.fields.resultType?e.fields.threshold||1:100,r}return r(e,t),e.prototype.read=function(){var t;if((t="id"===this.selectorType?document.getElementById(this.selector):document.querySelector(this.selector))instanceof HTMLElement){var e=function(t){if(null===t)return 0;var e=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),r=t.getBoundingClientRect().bottom,n=t.getBoundingClientRect().top;return 100*function(){var i=[];if(n<0&&i.push(Math.min(Math.abs(n),t.offsetHeight)),r>e){var o=Math.abs(r-e);i.push(Math.min(o,t.offsetHeight))}var s=i.reduce((function(t,e){return(t||0)+(e||0)}),0);return 0===s?1:s===t.offsetHeight?0:(t.offsetHeight-s)/t.offsetHeight}()}(t);if("boolean"===this.resultType)return e>this.threshold;if("percent"===this.resultType)return e}return"boolean"!==this.resultType&&0},e}(Qe),Br=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=Z.ElementVisible,e}return r(e,t),e.prototype.create=function(t){return new zr(n(n({},t),{environment:this.environment}))},e}(tr),Gr=function(t){function e(e){var r=t.call(this,e)||this;return r.type=Z.Utm,r.param=e.fields.param,r}return r(e,t),e.prototype.read=function(){var t=new P(window.location.href,!0);switch(this.param){case"content":return t.query.utm_content;case"campaign":return t.query.utm_campaign;case"medium":return t.query.utm_medium;case"source":return t.query.utm_source;case"term":return t.query.utm_term;default:return}},e}(Qe),Jr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=Z.Utm,e}return r(e,t),e.prototype.create=function(t){return new Gr(n(n({},t),{environment:this.environment}))},e}(tr),Kr=function(){function t(t,e){var r=this;this.variables={},this.factories={},this.registerFactory(new er(e),new ar(e),new ur(e),new hr(e),new dr(e),new vr(e),new yr(e),new br(e),new Er(e),new Lr(e),new Dr(e),new Pr(e),new Ar(e),new jr(e),new Br(e),new Jr(e)),Object.values(or).forEach((function(t){r.variables[$(t)]=r.factories[t].create()})),t.forEach((function(t){var e=t.type,n=i(t,["type"]);r.variables[t.strId]=r.factories[e].create(n)}))}return t.prototype.registerFactory=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];e.forEach((function(e){t.factories[e.type]=e}))},t.prototype.variable=function(t){return this.variables[t]},t.prototype.add=function(t,e,r){this.variables[e]=this.factories[t].create({strId:e,value:r})},t.prototype.readVariables=function(){var t=this,e={};return Object.keys(this.variables).forEach((function(r){var n=t.variables[r].read();"function"!=typeof n&&(e[r]=n)})),e},t.prototype.readBuildIntVariables=function(){var t=this,e={};return Object.keys(this.variables).forEach((function(r){if(r.startsWith(U)){var n=t.variables[r].read();"function"!=typeof n&&(e[r]=n)}})),e},t}();var $r=function(){function t(){}return t.formatting=function(e){return t.isActMsg(e)?n(n({},e),{data:n(n({},e.data),{act:n(n({},e.data.act),{event:n(n({},e.data.act.event),{element:e.data.act.event.element instanceof HTMLElement?t.formattingElement(e.data.act.event.element):void 0})})})}):e},t.isActMsg=function(t){return t.type===u.act},t.formattingElement=function(t){return t instanceof HTMLElement?function(t){var e,r,n,i,o="",s=t;for(e=0;s&&1===s.nodeType;s=s.parentNode,e++)r=0===s.childNodes.length?s.innerHTML:"",n=s.tagName.toLowerCase(),i=s.className,o=" "+(""!==s.id?"#"+s.id:i.length>0?n+"."+i.replace(/ /g,"."):n+(r.length>0?":contains('"+r+"')":""))+o;return o.trim()}(t):null},t}(),Yr=function(){function t(t){this.logger=t.logger,this.loggerListener=this.loggerListener.bind(this),this.debugCenterListener=this.debugCenterListener.bind(this),this.logger.events.registerListener("msg",this.loggerListener)}return t.isIncomingDebugMsg=function(e){return null!==e&&"object"==typeof e&&W(e,"source")&&e.source===t.DEBUG_MSG_SOURCE&&W(e,"type")&&(e.type===u.disconnect||e.type===u.connect||e.type===u.ping)},t.isOutComingDebugMsg=function(e){return null!==e&&"object"==typeof e&&W(e,"source")&&e.source===t.DEBUG_MSG_SOURCE&&W(e,"type")&&(e.type===u.init||e.type===u.act||e.type===u.ping||e.type===u.disconnect)},t.prototype.loggerListener=function(e){if(window.opener){var r=n(n({},$r.formatting(e)),{source:t.DEBUG_MSG_SOURCE});window.opener.postMessage(JSON.stringify(r),"*")}e.type===u.disconnect?window.removeEventListener("message",this.debugCenterListener,!1):e.type===u.init&&window.addEventListener("message",this.debugCenterListener,!1)},t.prototype.debugCenterListener=function(e){try{var r=JSON.parse(e.data);if(t.isIncomingDebugMsg(r)){r.source;var n=i(r,["source"]);this.logger.message(n)}}catch(t){}},t.DEBUG_MSG_SOURCE="ak-debug-center",t}(),Zr=function(){function t(t){var e,r,n,i=this,o=(r=window.location.href,n=new P(decodeURIComponent(r),!0),Boolean(n.query.actm_debug&&"true"===n.query.actm_debug)),s={isDebug:o,containerID:t.containerID,domain:t.domain};this.tagStorage=new Ze(t.tags,s),this.variableStorage=new Kr(t.variables,s),this.instructionStorage=new ie({instructions:t.instructions,deps:{tagStorage:this.tagStorage}}),this.dataLayerController=new Q({variableStorage:this.variableStorage}),this.triggersStorage=new ke({triggers:t.triggers,deps:{dataLayer:this.dataLayerController,variableStorage:this.variableStorage}}),this.actManager=new re({instructionStorage:this.instructionStorage,triggerStorage:this.triggersStorage}),this.actManager.events.registerListener("act",(function(t){i.dataLayerController.addInsideItem(t.event)})),this.dataLayerController.events.registerListener("outsideEvent",(function(t){i.actManager.emitEvent(t)})),this.logger=new h({mode:o?"debug":"prod",manager:this.actManager,variableStorage:this.variableStorage}),o&&(this.sender=new Yr({logger:this.logger}),this.logger.start()),(e=this.dataLayerController).addOutsideItem.apply(e,c([],a(t.initialDataLayer),!1)),this.reset=this.reset.bind(this),this.spyChangePage(),this.spyChangeHistory(),this.actManager.initialization()}return t.prototype.reset=function(){this.actManager.clean()},t.prototype.spyChangePage=function(){window.addEventListener("beforeunload",this.reset)},t.prototype.spyChangeHistory=function(){var t=this;window.addEventListener("popstate",this.reset),window.history.pushState=Yt(window.history.pushState,{apply:function(e,r,n){t.reset(),e.apply(r,n)}}),window.history.replaceState=Yt(window.history.replaceState,{apply:function(e,r,n){t.reset(),e.apply(r,n)}})},t}();var Qr=JSON.parse('{"domain":"https://maksimlavrenyuk.github.io","dataLayerName":"acDataLayer","containerVersion":1,"containerID":"ACTM-1","triggers":[{"strId":"trigger1","type":"click","segment":{"queries":[{"argument":"elementId","filter":"init_sub","operator":"equals"}]}}],"variables":[],"tags":[{"type":"push","fields":{"resourceToken":"6Z9sTw3NMdm-453ae7a84c1ec8b4","verbose":false},"strId":"tag1"}],"instructions":[{"strId":"instruction1","firingOption":"once_per_event","priority":0,"tag":"tag1","triggers":["trigger1"]}]}'),Xr=window[Qr.dataLayerName||"acDataLayer"];new Zr({tags:Qr.tags,variables:Qr.variables,instructions:Qr.instructions,triggers:Qr.triggers,containerID:Qr.containerID,initialDataLayer:Xr,domain:Qr.domain})}();
//# sourceMappingURL=actm.js.map
